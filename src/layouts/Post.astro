---
import { format, parseISO } from 'date-fns';
import Layout from 'layouts/Layout.astro';
import { Img } from 'astro-imagetools/components';
import author from '../author.json';
import type { Post } from 'types';

type Props = Post;

const { title, publishedAt, external, minutesRead, cover } =
  Astro.props.frontmatter;

console.log(Astro.props);

const publishDate = format(parseISO(publishedAt), 'MMMM d, yyyy');
// const { minutesRead: readingTime, cover } = Astro.props.frontmatter;
---

<Layout title={title} canonical={external} date={publishedAt}>
  <div class="rounded-xl sm:rounded-3xl overflow-hidden">
    <Img format="webp" src={cover} alt={title} width={1400} height={600} />
  </div>

  <article
    class="my-6"
    item-prop="blogPost"
    item-scope
    item-type="https://schema.org/BlogPosting"
  >
    <h1
      class="text-3xl md:text-4xl font-bold tracking-tight mb-6"
      item-prop="name headline"
    >
      {title}
    </h1>
    <header class="flex items-center mb-8 sm:mb-10">
      <figure
        class="w-8 h-8 sm:w-6 sm:h-6 mr-4 rounded-full overflow-hidden flex-shrink-0"
      >
        <img src={author.avatar} alt={author.name} />
      </figure>
      <div
        class="flex flex-col sm:flex-row sm:justify-between sm:w-full text-sm"
      >
        <div class="text-slate-600 dark:text-slate-400">
          <span
            item-prop="author"
            item-scope
            item-type="https://schema.org/Person"
          >
            <span item-prop="name">{author.name}</span>
          </span>
          at
          <time item-prop="datePublished" date-time={publishedAt}>
            {publishDate}
          </time>
        </div>
        <div class="text-slate-500">
          {minutesRead}
        </div>
      </div>
    </header>
    <section
      class="prose dark:prose-dark w-full mb-6 mx-auto"
      item-prop="articleBody"
    >
      <slot />
    </section>
  </article>
</Layout>
