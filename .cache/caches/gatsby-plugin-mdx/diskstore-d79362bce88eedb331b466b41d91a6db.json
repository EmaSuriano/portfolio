{"expireTime":9007200917126767000,"key":"gatsby-plugin-mdx-entire-payload-4fca3b1f141d043d80342ef9d30099a2-","val":{"mdast":{"type":"root","children":[{"type":"paragraph","children":[{"type":"text","value":"My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.","position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":142,"offset":142},"indent":[]}}],"position":{"start":{"line":2,"column":1,"offset":1},"end":{"line":2,"column":142,"offset":142},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"I‚Äôve always had visual testing in my TODO list until a few weeks ago when I finally decided to mark it as done. In this article, I am going to share my experience working with this strategy of testing (which does ","position":{"start":{"line":4,"column":1,"offset":144},"end":{"line":4,"column":214,"offset":357},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"NOT","position":{"start":{"line":4,"column":216,"offset":359},"end":{"line":4,"column":219,"offset":362},"indent":[]}}],"position":{"start":{"line":4,"column":214,"offset":357},"end":{"line":4,"column":221,"offset":364},"indent":[]}},{"type":"text","value":" replace the others) and the integration with my current development tool: ","position":{"start":{"line":4,"column":221,"offset":364},"end":{"line":4,"column":296,"offset":439},"indent":[]}},{"type":"link","title":null,"url":"https://storybook.js.org/","children":[{"type":"text","value":"Storybook","position":{"start":{"line":4,"column":297,"offset":440},"end":{"line":4,"column":306,"offset":449},"indent":[]}}],"position":{"start":{"line":4,"column":296,"offset":439},"end":{"line":4,"column":334,"offset":477},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":4,"column":334,"offset":477},"end":{"line":4,"column":335,"offset":478},"indent":[]}}],"position":{"start":{"line":4,"column":1,"offset":144},"end":{"line":4,"column":335,"offset":478},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In case you don‚Äôt know what Storybook is, this is the definition they provide on the official website:","position":{"start":{"line":6,"column":1,"offset":480},"end":{"line":6,"column":103,"offset":582},"indent":[]}}],"position":{"start":{"line":6,"column":1,"offset":480},"end":{"line":6,"column":103,"offset":582},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/storybook-demo.gif\" alt=\"Storybook Demo\" />\n  <figcaption>Storybook Demo</figcaption>\n</div>","position":{"start":{"line":8,"column":1,"offset":584},"end":{"line":11,"column":7,"offset":724},"indent":[1,1,1]}},{"type":"blockquote","children":[{"type":"paragraph","children":[{"type":"text","value":"Storybook is an open source tool for developing UI components in isolation for React, Vue, and Angular. It makes building stunning UIs organized and efficient.","position":{"start":{"line":13,"column":3,"offset":728},"end":{"line":13,"column":162,"offset":887},"indent":[]}}],"position":{"start":{"line":13,"column":3,"offset":728},"end":{"line":13,"column":162,"offset":887},"indent":[]}}],"position":{"start":{"line":13,"column":1,"offset":726},"end":{"line":13,"column":162,"offset":887},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Regarding ","position":{"start":{"line":15,"column":1,"offset":889},"end":{"line":15,"column":11,"offset":899},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"visual testing","position":{"start":{"line":15,"column":13,"offset":901},"end":{"line":15,"column":27,"offset":915},"indent":[]}}],"position":{"start":{"line":15,"column":11,"offset":899},"end":{"line":15,"column":29,"offset":917},"indent":[]}},{"type":"text","value":", it‚Äôs a testing approach that consists of taking real pictures and then compare them with the previous version. This comparison is made by comparing both pictures and checking if the pixels match.","position":{"start":{"line":15,"column":29,"offset":917},"end":{"line":15,"column":226,"offset":1114},"indent":[]}}],"position":{"start":{"line":15,"column":1,"offset":889},"end":{"line":15,"column":226,"offset":1114},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In case you already understand the concept of ","position":{"start":{"line":17,"column":1,"offset":1116},"end":{"line":17,"column":47,"offset":1162},"indent":[]}},{"type":"link","title":null,"url":"https://jestjs.io/docs/en/snapshot-testing","children":[{"type":"text","value":"Snapshot Testing","position":{"start":{"line":17,"column":48,"offset":1163},"end":{"line":17,"column":64,"offset":1179},"indent":[]}}],"position":{"start":{"line":17,"column":47,"offset":1162},"end":{"line":17,"column":109,"offset":1224},"indent":[]}},{"type":"text","value":", this is the same. The difference is you compare a picture and not some resulting code.","position":{"start":{"line":17,"column":109,"offset":1224},"end":{"line":17,"column":197,"offset":1312},"indent":[]}}],"position":{"start":{"line":17,"column":1,"offset":1116},"end":{"line":17,"column":197,"offset":1312},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Medium\">\n  <img src=\"./images/visual-diff.jpg\" alt=\"Example of Visual Testing Diff\" />\n  <figcaption>Example of Visual Testing Diff</figcaption>\n</div>","position":{"start":{"line":19,"column":1,"offset":1314},"end":{"line":22,"column":7,"offset":1484},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In case you are thinking ","position":{"start":{"line":24,"column":1,"offset":1486},"end":{"line":24,"column":26,"offset":1511},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"‚ÄúBut how are these two concepts connected?‚Äù","position":{"start":{"line":24,"column":27,"offset":1512},"end":{"line":24,"column":70,"offset":1555},"indent":[]}}],"position":{"start":{"line":24,"column":26,"offset":1511},"end":{"line":24,"column":71,"offset":1556},"indent":[]}},{"type":"text","value":". Storybook insists on developing your components in isolation, which is the best scenario to do Visual Testing in order to avoid unwanted differences in our images. One way of thinking about this approach is like, ","position":{"start":{"line":24,"column":71,"offset":1556},"end":{"line":24,"column":286,"offset":1771},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"every story","position":{"start":{"line":24,"column":288,"offset":1773},"end":{"line":24,"column":299,"offset":1784},"indent":[]}}],"position":{"start":{"line":24,"column":286,"offset":1771},"end":{"line":24,"column":301,"offset":1786},"indent":[]}},{"type":"text","value":" defined in Storybook is a ","position":{"start":{"line":24,"column":301,"offset":1786},"end":{"line":24,"column":328,"offset":1813},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"visual test","position":{"start":{"line":24,"column":330,"offset":1815},"end":{"line":24,"column":341,"offset":1826},"indent":[]}}],"position":{"start":{"line":24,"column":328,"offset":1813},"end":{"line":24,"column":343,"offset":1828},"indent":[]}},{"type":"text","value":" in our application.","position":{"start":{"line":24,"column":343,"offset":1828},"end":{"line":24,"column":363,"offset":1848},"indent":[]}}],"position":{"start":{"line":24,"column":1,"offset":1486},"end":{"line":24,"column":363,"offset":1848},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"One last thing before checking the implementation, there are excellent services out there that I tried and they work flawlessly like ","position":{"start":{"line":26,"column":1,"offset":1850},"end":{"line":26,"column":134,"offset":1983},"indent":[]}},{"type":"link","title":null,"url":"https://percy.io","children":[{"type":"text","value":"Percy","position":{"start":{"line":26,"column":135,"offset":1984},"end":{"line":26,"column":140,"offset":1989},"indent":[]}}],"position":{"start":{"line":26,"column":134,"offset":1983},"end":{"line":26,"column":159,"offset":2008},"indent":[]}},{"type":"text","value":", ","position":{"start":{"line":26,"column":159,"offset":2008},"end":{"line":26,"column":161,"offset":2010},"indent":[]}},{"type":"link","title":null,"url":"https://applitools.com/","children":[{"type":"text","value":"Applitool","position":{"start":{"line":26,"column":162,"offset":2011},"end":{"line":26,"column":171,"offset":2020},"indent":[]}}],"position":{"start":{"line":26,"column":161,"offset":2010},"end":{"line":26,"column":197,"offset":2046},"indent":[]}},{"type":"text","value":", and many more. In this article, I want to show the ","position":{"start":{"line":26,"column":197,"offset":2046},"end":{"line":26,"column":250,"offset":2099},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"handmade way ","position":{"start":{"line":26,"column":251,"offset":2100},"end":{"line":26,"column":264,"offset":2113},"indent":[]}}],"position":{"start":{"line":26,"column":250,"offset":2099},"end":{"line":26,"column":265,"offset":2114},"indent":[]}},{"type":"text","value":"of implementing a visual testing workflow, which has its own cons and pros regarding the mentioned services.","position":{"start":{"line":26,"column":265,"offset":2114},"end":{"line":26,"column":373,"offset":2222},"indent":[]}}],"position":{"start":{"line":26,"column":1,"offset":1850},"end":{"line":26,"column":373,"offset":2222},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/show-time.gif\" alt=\"It's Show Time\" />\n  <figcaption>It's Show Time</figcaption>\n</div>","position":{"start":{"line":28,"column":1,"offset":2224},"end":{"line":31,"column":7,"offset":2359},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Let‚Äôs start with a fresh project by bootstrapping it with ","position":{"start":{"line":33,"column":1,"offset":2361},"end":{"line":33,"column":59,"offset":2419},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/facebook/create-react-app","children":[{"type":"text","value":"create-react-app","position":{"start":{"line":33,"column":60,"offset":2420},"end":{"line":33,"column":76,"offset":2436},"indent":[]}}],"position":{"start":{"line":33,"column":59,"offset":2419},"end":{"line":33,"column":123,"offset":2483},"indent":[]}},{"type":"text","value":" and installing Storybook using its CLI.","position":{"start":{"line":33,"column":123,"offset":2483},"end":{"line":33,"column":163,"offset":2523},"indent":[]}}],"position":{"start":{"line":33,"column":1,"offset":2361},"end":{"line":33,"column":163,"offset":2523},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"$ npx create-react-app visual-testing-with-storybook\n$ cd visual-testing-with-storybook\n$ npx -p @storybook/cli sb init","position":{"start":{"line":35,"column":1,"offset":2525},"end":{"line":39,"column":4,"offset":2656},"indent":[1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"When the installation is finished you can check if everything was set up properly by running yarn storybook , and you should see the Homepage with two stories that were created by default.","position":{"start":{"line":41,"column":1,"offset":2658},"end":{"line":41,"column":189,"offset":2846},"indent":[]}}],"position":{"start":{"line":41,"column":1,"offset":2658},"end":{"line":41,"column":189,"offset":2846},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Large\">\n  <img src=\"./images/storybook-homepage.jpg\" alt=\"Storybook Homepage\" />\n  <figcaption>Storybook Homepage</figcaption>\n</div>","position":{"start":{"line":43,"column":1,"offset":2848},"end":{"line":46,"column":7,"offset":3000},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Now let‚Äôs create a simple component for testing. I decided to create a simple Button called DuplicationButton , in which every time the user clicks on it the children provided by props will be duplicated. Not really useful but it will serve as a great example!","position":{"start":{"line":48,"column":1,"offset":3002},"end":{"line":48,"column":261,"offset":3262},"indent":[]}}],"position":{"start":{"line":48,"column":1,"offset":3002},"end":{"line":48,"column":261,"offset":3262},"indent":[]}},{"type":"code","lang":"jsx","meta":null,"value":"import React, { useState } from 'react';\n\nconst ButtonStyle = {\n  padding: '10px',\n  borderRadius: '5px',\n  fontSize: '16px',\n  border: 'pink 3px solid',\n};\n\nconst DuplicationButton = ({ children }) => {\n  const [count, setCount] = useState(1);\n\n  return (\n    <button style={ButtonStyle} onClick={() => setCount(count + 1)}>\n      {new Array(count).fill(children)}\n    </button>\n  );\n};\n\nexport default DuplicationButton;","position":{"start":{"line":50,"column":1,"offset":3264},"end":{"line":71,"column":4,"offset":3697},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Let‚Äôs add some stories for the component.","position":{"start":{"line":73,"column":1,"offset":3699},"end":{"line":73,"column":42,"offset":3740},"indent":[]}}],"position":{"start":{"line":73,"column":1,"offset":3699},"end":{"line":73,"column":42,"offset":3740},"indent":[]}},{"type":"code","lang":"jsx","meta":null,"value":"import React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport DuplicationButton from './DuplicationButton';\n\nstoriesOf('DuplicationButton', module)\n  .add('Good', () => (\n    <DuplicationButton>\n      <span role=\"img\" aria-label=\"angel\">\n        üòá\n      </span>\n    </DuplicationButton>\n  ))\n  .add('Bad', () => (\n    <DuplicationButton>\n      <span role=\"img\" aria-label=\"devil\">\n        üòà\n      </span>\n    </DuplicationButton>\n  ));","position":{"start":{"line":75,"column":1,"offset":3742},"end":{"line":95,"column":4,"offset":4208},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"And this is how it looks in Storybook.","position":{"start":{"line":97,"column":1,"offset":4210},"end":{"line":97,"column":39,"offset":4248},"indent":[]}}],"position":{"start":{"line":97,"column":1,"offset":4210},"end":{"line":97,"column":39,"offset":4248},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/duplication-button.gif\" alt=\"Demo DuplicationButton stories\" />\n  <figcaption>Demo DuplicationButton stories</figcaption>\n</div>","position":{"start":{"line":99,"column":1,"offset":4250},"end":{"line":102,"column":7,"offset":4426},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Generating tests based on stories üß™","position":{"start":{"line":104,"column":4,"offset":4431},"end":{"line":104,"column":40,"offset":4467},"indent":[]}}],"position":{"start":{"line":104,"column":1,"offset":4428},"end":{"line":104,"column":40,"offset":4467},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In order to implement one test per story, there is a really helpful add-on in Storybook called ","position":{"start":{"line":106,"column":1,"offset":4469},"end":{"line":106,"column":96,"offset":4564},"indent":[]}},{"type":"link","title":null,"url":"https://www.npmjs.com/package/@storybook/addon-storyshots","children":[{"type":"text","value":"storyshots","position":{"start":{"line":106,"column":97,"offset":4565},"end":{"line":106,"column":107,"offset":4575},"indent":[]}}],"position":{"start":{"line":106,"column":96,"offset":4564},"end":{"line":106,"column":167,"offset":4635},"indent":[]}},{"type":"text","value":". In order to install it, you need to run:","position":{"start":{"line":106,"column":167,"offset":4635},"end":{"line":106,"column":209,"offset":4677},"indent":[]}}],"position":{"start":{"line":106,"column":1,"offset":4469},"end":{"line":106,"column":209,"offset":4677},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"$ yarn add -D @storybook/addon-storyshots react-test-renderer","position":{"start":{"line":108,"column":1,"offset":4679},"end":{"line":110,"column":4,"offset":4752},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Then create a test file where you initialize ","position":{"start":{"line":112,"column":1,"offset":4754},"end":{"line":112,"column":46,"offset":4799},"indent":[]}},{"type":"inlineCode","value":"storyshots","position":{"start":{"line":112,"column":46,"offset":4799},"end":{"line":112,"column":58,"offset":4811},"indent":[]}},{"type":"text","value":". Let‚Äôs name it ","position":{"start":{"line":112,"column":58,"offset":4811},"end":{"line":112,"column":74,"offset":4827},"indent":[]}},{"type":"inlineCode","value":"storyshots.test.js","position":{"start":{"line":112,"column":74,"offset":4827},"end":{"line":112,"column":94,"offset":4847},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":112,"column":94,"offset":4847},"end":{"line":112,"column":95,"offset":4848},"indent":[]}}],"position":{"start":{"line":112,"column":1,"offset":4754},"end":{"line":112,"column":95,"offset":4848},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"// src/storyshots.test.js**\nimport** initStoryshots **from** '@storybook/addon-storyshots';\n\ninitStoryshots({ */* configuration options */* });","position":{"start":{"line":114,"column":1,"offset":4850},"end":{"line":119,"column":4,"offset":5011},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In order to run it, execute yarn test. Now for each story, there is a test with a ","position":{"start":{"line":121,"column":1,"offset":5013},"end":{"line":121,"column":83,"offset":5095},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"snapshot","position":{"start":{"line":121,"column":84,"offset":5096},"end":{"line":121,"column":92,"offset":5104},"indent":[]}}],"position":{"start":{"line":121,"column":83,"offset":5095},"end":{"line":121,"column":93,"offset":5105},"indent":[]}},{"type":"text","value":" where you can check what is the output (component rendered) of the story. These ","position":{"start":{"line":121,"column":93,"offset":5105},"end":{"line":121,"column":174,"offset":5186},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"snapshots","position":{"start":{"line":121,"column":175,"offset":5187},"end":{"line":121,"column":184,"offset":5196},"indent":[]}}],"position":{"start":{"line":121,"column":174,"offset":5186},"end":{"line":121,"column":185,"offset":5197},"indent":[]}},{"type":"text","value":" are going to be automatically generated every time we run our tests, and in case they have a difference with the previous one the test will fail.","position":{"start":{"line":121,"column":185,"offset":5197},"end":{"line":121,"column":331,"offset":5343},"indent":[]}}],"position":{"start":{"line":121,"column":1,"offset":5013},"end":{"line":121,"column":331,"offset":5343},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Medium\">\n  <img src=\"./images/result-storyshots.jpg\" alt=\"Test result with storyshots\" />\n  <figcaption>Test result with storyshots</figcaption>\n</div>","position":{"start":{"line":123,"column":1,"offset":5345},"end":{"line":126,"column":7,"offset":5515},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Let‚Äôs get Visual! üåà","position":{"start":{"line":128,"column":4,"offset":5520},"end":{"line":128,"column":24,"offset":5540},"indent":[]}}],"position":{"start":{"line":128,"column":1,"offset":5517},"end":{"line":128,"column":24,"offset":5540},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/visual-illusion.gif\" alt=\"Visual Illusion\" />\n  <figcaption>Visual Illusion</figcaption>\n</div>","position":{"start":{"line":130,"column":1,"offset":5542},"end":{"line":133,"column":7,"offset":5685},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In the code from above, the function initStoryshots accepts a configuration object with an option called test that allows us to change the comparison method for each story/test.","position":{"start":{"line":135,"column":1,"offset":5687},"end":{"line":135,"column":178,"offset":5864},"indent":[]}}],"position":{"start":{"line":135,"column":1,"offset":5687},"end":{"line":135,"column":178,"offset":5864},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Luckily, there is an add-on called ","position":{"start":{"line":137,"column":1,"offset":5866},"end":{"line":137,"column":36,"offset":5901},"indent":[]}},{"type":"link","title":null,"url":"https://www.npmjs.com/package/@storybook/addon-storyshots-puppeteer","children":[{"type":"text","value":"storyshot-puppeteer","position":{"start":{"line":137,"column":37,"offset":5902},"end":{"line":137,"column":56,"offset":5921},"indent":[]}}],"position":{"start":{"line":137,"column":36,"offset":5901},"end":{"line":137,"column":126,"offset":5991},"indent":[]}},{"type":"text","value":" , which as the name state creates an instance of a browser, navigates to the story, takes a picture and compares it with the previous one! In order to install it:","position":{"start":{"line":137,"column":126,"offset":5991},"end":{"line":137,"column":289,"offset":6154},"indent":[]}}],"position":{"start":{"line":137,"column":1,"offset":5866},"end":{"line":137,"column":289,"offset":6154},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"$ yarn add -D @storybook/addon-storyshots-puppeteer","position":{"start":{"line":139,"column":1,"offset":6156},"end":{"line":141,"column":4,"offset":6219},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Then inside the storyshots file, you need to override the test comparison with imageSnapshot from the puppeteer add-on. Also, it‚Äôs needed to specify the URL where storybook will be running in order to know where to navigate.","position":{"start":{"line":143,"column":1,"offset":6221},"end":{"line":143,"column":225,"offset":6445},"indent":[]}}],"position":{"start":{"line":143,"column":1,"offset":6221},"end":{"line":143,"column":225,"offset":6445},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"// src/storyshots.test.js\nimport initStoryshots from '[@storybook/addon-storyshots](http://twitter.com/storybook/addon-storyshots)';\nimport { imageSnapshot } from '[@storybook/addon-storyshots-puppetee](http://twitter.com/storybook/addon-storyshots-puppetee)r';\n\ninitStoryshots({\n  test: imageSnapshot({ storybookUrl: '[http://localhost:9009/'](http://localhost:9009/') }),\n});","position":{"start":{"line":145,"column":1,"offset":6447},"end":{"line":153,"column":4,"offset":6842},"indent":[1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"One thing to mention is that now our tests depends on having an instance of storybook running. I recommend managing two terminals at the same time for this kind of scenarios: in one terminal you run yarn storybook and in another yarn test .","position":{"start":{"line":155,"column":1,"offset":6844},"end":{"line":155,"column":241,"offset":7084},"indent":[]}}],"position":{"start":{"line":155,"column":1,"offset":6844},"end":{"line":155,"column":241,"offset":7084},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Large\">\n  <img src=\"./images/visual-testing-storyshots.jpg\" alt=\"Running visual testing along with Storybook\" />\n  <figcaption>Running visual testing along with Storybook</figcaption>\n</div>","position":{"start":{"line":157,"column":1,"offset":7086},"end":{"line":160,"column":7,"offset":7295},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The old snapshots are obsolete (you can safely delete them) because now we have a new folder called ","position":{"start":{"line":162,"column":1,"offset":7297},"end":{"line":162,"column":101,"offset":7397},"indent":[]}},{"type":"strong","children":[{"type":"text","value":"image_snapshots","position":{"start":{"line":162,"column":103,"offset":7399},"end":{"line":162,"column":118,"offset":7414},"indent":[]}}],"position":{"start":{"line":162,"column":101,"offset":7397},"end":{"line":162,"column":120,"offset":7416},"indent":[]}},{"type":"text","value":" where there is a picture for each story. And every time a component changes what it renders, tests will fail and you can check it with a visual diffing between the stored image snapshot and the new image.","position":{"start":{"line":162,"column":120,"offset":7416},"end":{"line":162,"column":325,"offset":7621},"indent":[]}}],"position":{"start":{"line":162,"column":1,"offset":7297},"end":{"line":162,"column":325,"offset":7621},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"In the following diffing I changed the border-color of the button from pink to blue. The original image will be on the left, the new on the right and in the middle the difference between both with the changes in red color.","position":{"start":{"line":164,"column":1,"offset":7623},"end":{"line":164,"column":223,"offset":7845},"indent":[]}}],"position":{"start":{"line":164,"column":1,"offset":7623},"end":{"line":164,"column":223,"offset":7845},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Large\">\n  <img src=\"./images/visual-testing-storyshots.jpg\" alt=\"Visual diffing in action\" />\n  <figcaption>Visual diffing in action</figcaption>\n</div>","position":{"start":{"line":166,"column":1,"offset":7847},"end":{"line":169,"column":7,"offset":8018},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Running on CI ‚öôÔ∏è","position":{"start":{"line":171,"column":4,"offset":8023},"end":{"line":171,"column":20,"offset":8039},"indent":[]}}],"position":{"start":{"line":171,"column":1,"offset":8020},"end":{"line":171,"column":20,"offset":8039},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Having two terminal opened at the same time it‚Äôs something that we can only do in development. But when it comes to automatize this task, things can be a little bit tricky.","position":{"start":{"line":173,"column":1,"offset":8041},"end":{"line":173,"column":173,"offset":8213},"indent":[]}}],"position":{"start":{"line":173,"column":1,"offset":8041},"end":{"line":173,"column":173,"offset":8213},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Luckily someone thought about this problem and made an npm package, called ","position":{"start":{"line":175,"column":1,"offset":8215},"end":{"line":175,"column":76,"offset":8290},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/bahmutov/start-server-and-test","children":[{"type":"text","value":"start-server-and-test","position":{"start":{"line":175,"column":77,"offset":8291},"end":{"line":175,"column":98,"offset":8312},"indent":[]}}],"position":{"start":{"line":175,"column":76,"offset":8290},"end":{"line":175,"column":150,"offset":8364},"indent":[]}},{"type":"text","value":" which does exactly that! You need to specify the command to ","position":{"start":{"line":175,"column":150,"offset":8364},"end":{"line":175,"column":211,"offset":8425},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"‚Äústart the server‚Äù","position":{"start":{"line":175,"column":212,"offset":8426},"end":{"line":175,"column":230,"offset":8444},"indent":[]}}],"position":{"start":{"line":175,"column":211,"offset":8425},"end":{"line":175,"column":231,"offset":8445},"indent":[]}},{"type":"text","value":", once the server is up and running, it will the command of ","position":{"start":{"line":175,"column":231,"offset":8445},"end":{"line":175,"column":291,"offset":8505},"indent":[]}},{"type":"emphasis","children":[{"type":"text","value":"‚Äútest‚Äù","position":{"start":{"line":175,"column":292,"offset":8506},"end":{"line":175,"column":298,"offset":8512},"indent":[]}}],"position":{"start":{"line":175,"column":291,"offset":8505},"end":{"line":175,"column":299,"offset":8513},"indent":[]}},{"type":"text","value":" that you specified and once that process is done it will kill the server.","position":{"start":{"line":175,"column":299,"offset":8513},"end":{"line":175,"column":373,"offset":8587},"indent":[]}}],"position":{"start":{"line":175,"column":1,"offset":8215},"end":{"line":175,"column":373,"offset":8587},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"yarn add start-server-and-test","position":{"start":{"line":177,"column":1,"offset":8589},"end":{"line":179,"column":4,"offset":8631},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Inside package.json , you need to create a new script which will start storybook, then listen until ","position":{"start":{"line":181,"column":1,"offset":8633},"end":{"line":181,"column":101,"offset":8733},"indent":[]}},{"type":"link","title":null,"url":"http://localhost:9009","children":[{"type":"text","value":"http://localhost:9009","position":{"start":{"line":181,"column":102,"offset":8734},"end":{"line":181,"column":123,"offset":8755},"indent":[]}}],"position":{"start":{"line":181,"column":101,"offset":8733},"end":{"line":181,"column":147,"offset":8779},"indent":[]}},{"type":"text","value":" is up and running and execute the tests.","position":{"start":{"line":181,"column":147,"offset":8779},"end":{"line":181,"column":188,"offset":8820},"indent":[]}}],"position":{"start":{"line":181,"column":1,"offset":8633},"end":{"line":181,"column":188,"offset":8820},"indent":[]}},{"type":"code","lang":"json","meta":null,"value":"\"scripts\": {\n  \"test\": \"react-scripts test --coverage\",\n  \"storybook\": \"start-storybook -p 9009 -s public\",\n  \"test:ci\": \"start-server-and-test storybook [http://localhost:9009](http://localhost:9009) test\",\n},","position":{"start":{"line":183,"column":1,"offset":8822},"end":{"line":189,"column":4,"offset":9044},"indent":[1,1,1,1,1,1]}},{"type":"jsx","value":"<div class=\"Image__Medium\">\n  <img src=\"./images/ci-output.jpg\" alt=\"Test CI output\" />\n  <figcaption>Test CI output</figcaption>\n</div>","position":{"start":{"line":191,"column":1,"offset":9046},"end":{"line":194,"column":7,"offset":9182},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Interactive Visual Testing üï∫","position":{"start":{"line":196,"column":4,"offset":9187},"end":{"line":196,"column":33,"offset":9216},"indent":[]}}],"position":{"start":{"line":196,"column":1,"offset":9184},"end":{"line":196,"column":33,"offset":9216},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"Sometimes you would like to interact with the story before taking the picture. In order to do that, you need to follow a different approach than the previously showed. You can achieve this by using a customer jest matcher called ","position":{"start":{"line":198,"column":1,"offset":9218},"end":{"line":198,"column":230,"offset":9447},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/americanexpress/jest-image-snapshot","children":[{"type":"text","value":"jest-image-snapshot","position":{"start":{"line":198,"column":231,"offset":9448},"end":{"line":198,"column":250,"offset":9467},"indent":[]}}],"position":{"start":{"line":198,"column":230,"offset":9447},"end":{"line":198,"column":307,"offset":9524},"indent":[]}},{"type":"text","value":" , and any end-to-end framework. In this case, picked ","position":{"start":{"line":198,"column":307,"offset":9524},"end":{"line":198,"column":361,"offset":9578},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/GoogleChrome/puppeteer","children":[{"type":"text","value":"puppeteer","position":{"start":{"line":198,"column":362,"offset":9579},"end":{"line":198,"column":371,"offset":9588},"indent":[]}}],"position":{"start":{"line":198,"column":361,"offset":9578},"end":{"line":198,"column":415,"offset":9632},"indent":[]}},{"type":"text","value":" .","position":{"start":{"line":198,"column":415,"offset":9632},"end":{"line":198,"column":417,"offset":9634},"indent":[]}}],"position":{"start":{"line":198,"column":1,"offset":9218},"end":{"line":198,"column":417,"offset":9634},"indent":[]}},{"type":"code","lang":"bash","meta":null,"value":"yarn add -D jest-image-snapshot puppeteer","position":{"start":{"line":200,"column":1,"offset":9636},"end":{"line":202,"column":4,"offset":9689},"indent":[1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In order to enable jest-image-snapshot, you need to extend the function expect from jest . The ","position":{"start":{"line":204,"column":1,"offset":9691},"end":{"line":204,"column":96,"offset":9786},"indent":[]}},{"type":"link","title":null,"url":"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs","children":[{"type":"text","value":"recommended way","position":{"start":{"line":204,"column":97,"offset":9787},"end":{"line":204,"column":112,"offset":9802},"indent":[]}}],"position":{"start":{"line":204,"column":96,"offset":9786},"end":{"line":204,"column":194,"offset":9884},"indent":[]}},{"type":"text","value":" of achieving this with create-react-app is by creating a file inside src with the name of setupTests.js . This file will be loaded before all the tests started, which will enable us to use this custom matcher.","position":{"start":{"line":204,"column":194,"offset":9884},"end":{"line":204,"column":404,"offset":10094},"indent":[]}}],"position":{"start":{"line":204,"column":1,"offset":9691},"end":{"line":204,"column":404,"offset":10094},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"// src/setupTests.js\nimport { toMatchImageSnapshot } from 'jest-image-snapshot';\n\nexpect.extend({ toMatchImageSnapshot });","position":{"start":{"line":206,"column":1,"offset":10096},"end":{"line":211,"column":4,"offset":10236},"indent":[1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"Then create the test file when we are going to check the behavior of DuplicationButton, let‚Äôs check how it looks when the user clicks on it twice.","position":{"start":{"line":213,"column":1,"offset":10238},"end":{"line":213,"column":147,"offset":10384},"indent":[]}}],"position":{"start":{"line":213,"column":1,"offset":10238},"end":{"line":213,"column":147,"offset":10384},"indent":[]}},{"type":"code","lang":"javascript","meta":null,"value":"// src/DuplicationButton.test.js\nimport puppeteer from 'puppeteer';\n\ndescribe('<DuplicationButton />', () => {\n  let page;\n\n  beforeAll(async () => {\n    // init puppeteer page\n    let browser = await puppeteer.launch();\n    page = await browser.newPage();\n  });\n\n  it('should duplicate content after clicking', async () => {\n    // navigate to fullscreen story\n    await page.goto(\n      '[http://localhost:9009/iframe.html?id=duplicationbutton--good'](http://localhost:9009/iframe.html?id=duplicationbutton--good'),\n    );\n\n    // click on the button\n    await page.click('button');\n\n    // take screenshot and compare\n    const screenshot = await page.screenshot();\n    expect(screenshot).toMatchImageSnapshot();\n  });\n});","position":{"start":{"line":215,"column":1,"offset":10386},"end":{"line":242,"column":4,"offset":11129},"indent":[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"In order to run this test, we need to start Storybook or you can directly use yarn test:ci which will do it for you! This is how the screenshot looks like:","position":{"start":{"line":244,"column":1,"offset":11131},"end":{"line":244,"column":156,"offset":11286},"indent":[]}}],"position":{"start":{"line":244,"column":1,"offset":11131},"end":{"line":244,"column":156,"offset":11286},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/interactive-testing.jpg\" alt=\"Interactive visual testing\" />\n  <figcaption>Interactive visual testing</figcaption>\n</div>","position":{"start":{"line":246,"column":1,"offset":11288},"end":{"line":249,"column":7,"offset":11457},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"My Experience working with Visual Testing üôã‚Äç‚ôÇÔ∏è","position":{"start":{"line":251,"column":4,"offset":11462},"end":{"line":251,"column":51,"offset":11509},"indent":[]}}],"position":{"start":{"line":251,"column":1,"offset":11459},"end":{"line":251,"column":51,"offset":11509},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"As with all the new technologies/frameworks, I tried Visual testing first with a side project in which I saw a possible improvement. The project itself was a collection of weather icons made with React and ","position":{"start":{"line":253,"column":1,"offset":11511},"end":{"line":253,"column":207,"offset":11717},"indent":[]}},{"type":"link","title":null,"url":"https://www.styled-components.com/","children":[{"type":"text","value":"styled-components","position":{"start":{"line":253,"column":208,"offset":11718},"end":{"line":253,"column":225,"offset":11735},"indent":[]}}],"position":{"start":{"line":253,"column":207,"offset":11717},"end":{"line":253,"column":262,"offset":11772},"indent":[]}},{"type":"text","value":", called ","position":{"start":{"line":253,"column":262,"offset":11772},"end":{"line":253,"column":271,"offset":11781},"indent":[]}},{"type":"link","title":null,"url":"https://github.com/EmaSuriano/weather-styled-icon","children":[{"type":"text","value":"weather-styled-icon","position":{"start":{"line":253,"column":272,"offset":11782},"end":{"line":253,"column":291,"offset":11801},"indent":[]}}],"position":{"start":{"line":253,"column":271,"offset":11781},"end":{"line":253,"column":343,"offset":11853},"indent":[]}},{"type":"text","value":".","position":{"start":{"line":253,"column":343,"offset":11853},"end":{"line":253,"column":344,"offset":11854},"indent":[]}}],"position":{"start":{"line":253,"column":1,"offset":11511},"end":{"line":253,"column":344,"offset":11854},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Small\">\n  <img src=\"./images/weather-styled-icon.gif\" alt=\"weather-styled-icon showcase\" />\n  <figcaption>weather-styled-icon showcase</figcaption>\n</div>","position":{"start":{"line":255,"column":1,"offset":11856},"end":{"line":258,"column":7,"offset":12029},"indent":[1,1,1]}},{"type":"paragraph","children":[{"type":"text","value":"The first release I made of this library I wrote all the tests with enzyme, following a structural testing strategy. In simple words, I was rendering an icon with mount and then running checking if a node exists, and in order to check how it ‚Äúlooks‚Äù I was running ","position":{"start":{"line":260,"column":1,"offset":12031},"end":{"line":260,"column":265,"offset":12295},"indent":[]}},{"type":"inlineCode","value":"expect.toMatchSnapshot","position":{"start":{"line":260,"column":265,"offset":12295},"end":{"line":260,"column":289,"offset":12319},"indent":[]}},{"type":"text","value":" of the resulting styles. As you can imagine, this way of testing is very time consuming, but nevertheless, I was able to finish all of them.","position":{"start":{"line":260,"column":289,"offset":12319},"end":{"line":260,"column":430,"offset":12460},"indent":[]}}],"position":{"start":{"line":260,"column":1,"offset":12031},"end":{"line":260,"column":430,"offset":12460},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"The problem came when I decided to update the version of styled-components from v3 to v4 because I wanted to start using some of the cool new APIs, like ThemeProvider or the styledAPI to style existing styled-component components.","position":{"start":{"line":262,"column":1,"offset":12462},"end":{"line":262,"column":231,"offset":12692},"indent":[]}}],"position":{"start":{"line":262,"column":1,"offset":12462},"end":{"line":262,"column":231,"offset":12692},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"After I made all the changes inside the code, all my tests were broken due to I moved, added and removed components, also I changed the internal implementation of mostly all of them. At this point, I realized I was testing the implementation of my components and not the really the output I was expecting.","position":{"start":{"line":264,"column":1,"offset":12694},"end":{"line":264,"column":306,"offset":12999},"indent":[]}}],"position":{"start":{"line":264,"column":1,"offset":12694},"end":{"line":264,"column":306,"offset":12999},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"So I made the decision to give a try to Visual Testing because it seemed the most suitable testing strategy for my situation, where I want to check exactly how the icons and them variations looked like. I followed the same steps that I already explained above and I ended up having a better suite of tests with way less code. This is the difference of lines of the merged Pull Request!","position":{"start":{"line":266,"column":1,"offset":13001},"end":{"line":266,"column":386,"offset":13386},"indent":[]}}],"position":{"start":{"line":266,"column":1,"offset":13001},"end":{"line":266,"column":386,"offset":13386},"indent":[]}},{"type":"jsx","value":"<div class=\"Image__Medium\">\n  <img src=\"./images/pr-diff.jpg\" alt=\"Visual testing lines diff weather-styled-icon\" />\n  <figcaption>Visual testing lines diff weather-styled-icon</figcaption>\n</div>","position":{"start":{"line":268,"column":1,"offset":13388},"end":{"line":271,"column":7,"offset":13584},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Do‚Äôs and Dont‚Äôs ‚úçÔ∏è","position":{"start":{"line":273,"column":4,"offset":13589},"end":{"line":273,"column":22,"offset":13607},"indent":[]}}],"position":{"start":{"line":273,"column":1,"offset":13586},"end":{"line":273,"column":22,"offset":13607},"indent":[]}},{"type":"paragraph","children":[{"type":"text","value":"I think Visual Testing is an excellent way of testing and I highly encourage you to at least try it in a side project where you can play with it and see if you like it or not. However, I would like to highlight a few important things to do and NOT to do regarding this topic:","position":{"start":{"line":275,"column":1,"offset":13609},"end":{"line":275,"column":276,"offset":13884},"indent":[]}}],"position":{"start":{"line":275,"column":1,"offset":13609},"end":{"line":275,"column":276,"offset":13884},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå Don‚Äôt check the styles of your components with code, instead, take a real image of the component.","position":{"start":{"line":277,"column":3,"offset":13888},"end":{"line":277,"column":102,"offset":13987},"indent":[]}}],"position":{"start":{"line":277,"column":3,"offset":13888},"end":{"line":277,"column":102,"offset":13987},"indent":[]}}],"position":{"start":{"line":277,"column":1,"offset":13886},"end":{"line":277,"column":102,"offset":13987},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ In case you are using Storybook in your development workflow, you can have one visual test for all the stories without any real effort.","position":{"start":{"line":278,"column":3,"offset":13990},"end":{"line":278,"column":140,"offset":14127},"indent":[]}}],"position":{"start":{"line":278,"column":3,"offset":13990},"end":{"line":278,"column":140,"offset":14127},"indent":[]}}],"position":{"start":{"line":278,"column":1,"offset":13988},"end":{"line":278,"column":140,"offset":14127},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"‚ùå Visual testing does NOT replace other strategies of testing, it just adds another testing layer to your application.","position":{"start":{"line":279,"column":3,"offset":14130},"end":{"line":279,"column":121,"offset":14248},"indent":[]}}],"position":{"start":{"line":279,"column":3,"offset":14130},"end":{"line":279,"column":121,"offset":14248},"indent":[]}}],"position":{"start":{"line":279,"column":1,"offset":14128},"end":{"line":279,"column":121,"offset":14248},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"text","value":"‚úÖ You can easily integrate it with your current end-to-end tests.","position":{"start":{"line":280,"column":3,"offset":14251},"end":{"line":280,"column":68,"offset":14316},"indent":[]}}],"position":{"start":{"line":280,"column":3,"offset":14251},"end":{"line":280,"column":68,"offset":14316},"indent":[]}}],"position":{"start":{"line":280,"column":1,"offset":14249},"end":{"line":280,"column":68,"offset":14316},"indent":[]}}],"position":{"start":{"line":277,"column":1,"offset":13886},"end":{"line":280,"column":68,"offset":14316},"indent":[1,1,1]}},{"type":"heading","depth":2,"children":[{"type":"text","value":"Helpful Resources üìì","position":{"start":{"line":282,"column":4,"offset":14321},"end":{"line":282,"column":24,"offset":14341},"indent":[]}}],"position":{"start":{"line":282,"column":1,"offset":14318},"end":{"line":282,"column":24,"offset":14341},"indent":[]}},{"type":"list","ordered":false,"start":null,"spread":false,"children":[{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://github.com/EmaSuriano/visual-testing-storybook","children":[{"type":"text","value":"Link to the sample project","position":{"start":{"line":284,"column":4,"offset":14346},"end":{"line":284,"column":30,"offset":14372},"indent":[]}}],"position":{"start":{"line":284,"column":3,"offset":14345},"end":{"line":284,"column":87,"offset":14429},"indent":[]}}],"position":{"start":{"line":284,"column":3,"offset":14345},"end":{"line":284,"column":87,"offset":14429},"indent":[]}}],"position":{"start":{"line":284,"column":1,"offset":14343},"end":{"line":284,"column":87,"offset":14429},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://github.com/EmaSuriano/weather-styled-icon","children":[{"type":"text","value":"weather-styled-icon","position":{"start":{"line":285,"column":4,"offset":14433},"end":{"line":285,"column":23,"offset":14452},"indent":[]}}],"position":{"start":{"line":285,"column":3,"offset":14432},"end":{"line":285,"column":75,"offset":14504},"indent":[]}}],"position":{"start":{"line":285,"column":3,"offset":14432},"end":{"line":285,"column":75,"offset":14504},"indent":[]}}],"position":{"start":{"line":285,"column":1,"offset":14430},"end":{"line":285,"column":75,"offset":14504},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://storybook.js.org/docs/testing/automated-visual-testing/","children":[{"type":"text","value":"Automated Visual Testing ‚Äî Storybook Documentation","position":{"start":{"line":286,"column":4,"offset":14508},"end":{"line":286,"column":54,"offset":14558},"indent":[]}}],"position":{"start":{"line":286,"column":3,"offset":14507},"end":{"line":286,"column":120,"offset":14624},"indent":[]}}],"position":{"start":{"line":286,"column":3,"offset":14507},"end":{"line":286,"column":120,"offset":14624},"indent":[]}}],"position":{"start":{"line":286,"column":1,"offset":14505},"end":{"line":286,"column":120,"offset":14624},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://jestjs.io/docs/en/puppeteer","children":[{"type":"text","value":"Puppeteer with Jest","position":{"start":{"line":287,"column":4,"offset":14628},"end":{"line":287,"column":23,"offset":14647},"indent":[]}}],"position":{"start":{"line":287,"column":3,"offset":14627},"end":{"line":287,"column":61,"offset":14685},"indent":[]}}],"position":{"start":{"line":287,"column":3,"offset":14627},"end":{"line":287,"column":61,"offset":14685},"indent":[]}}],"position":{"start":{"line":287,"column":1,"offset":14625},"end":{"line":287,"column":61,"offset":14685},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://storybook.js.org/docs/testing/structural-testing/","children":[{"type":"text","value":"Structural Testing ‚Äî Storybook Documentation","position":{"start":{"line":288,"column":4,"offset":14689},"end":{"line":288,"column":48,"offset":14733},"indent":[]}}],"position":{"start":{"line":288,"column":3,"offset":14688},"end":{"line":288,"column":108,"offset":14793},"indent":[]}}],"position":{"start":{"line":288,"column":3,"offset":14688},"end":{"line":288,"column":108,"offset":14793},"indent":[]}}],"position":{"start":{"line":288,"column":1,"offset":14686},"end":{"line":288,"column":108,"offset":14793},"indent":[]}},{"type":"listItem","spread":false,"checked":null,"children":[{"type":"paragraph","children":[{"type":"link","title":null,"url":"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs","children":[{"type":"text","value":"Extending Jest config in create-react-app","position":{"start":{"line":289,"column":4,"offset":14797},"end":{"line":289,"column":45,"offset":14838},"indent":[]}}],"position":{"start":{"line":289,"column":3,"offset":14796},"end":{"line":289,"column":127,"offset":14920},"indent":[]}}],"position":{"start":{"line":289,"column":3,"offset":14796},"end":{"line":289,"column":127,"offset":14920},"indent":[]}}],"position":{"start":{"line":289,"column":1,"offset":14794},"end":{"line":289,"column":127,"offset":14920},"indent":[]}}],"position":{"start":{"line":284,"column":1,"offset":14343},"end":{"line":289,"column":127,"offset":14920},"indent":[1,1,1,1,1]}},{"type":"export","value":"export const _frontmatter = {\"title\":\"Using Storybook as a Visual Testing Platform\",\"author\":\"Ema Suriano\",\"date\":\"2019-04-28T00:00:00.000Z\",\"hero\":\"./images/hero.jpg\",\"excerpt\":\"My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.\",\"secret\":false}","position":{"start":{"line":292,"column":1,"offset":14923},"end":{"line":292,"column":338,"offset":15260},"indent":[]}}],"position":{"start":{"line":1,"column":1,"offset":0},"end":{"line":292,"column":338,"offset":15260}}},"scopeImports":["import * as React from 'react'"],"scopeIdentifiers":["React"],"body":"function _extends() { _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; }; return _extends.apply(this, arguments); }\n\nfunction _objectWithoutProperties(source, excluded) { if (source == null) return {}; var target = _objectWithoutPropertiesLoose(source, excluded); var key, i; if (Object.getOwnPropertySymbols) { var sourceSymbolKeys = Object.getOwnPropertySymbols(source); for (i = 0; i < sourceSymbolKeys.length; i++) { key = sourceSymbolKeys[i]; if (excluded.indexOf(key) >= 0) continue; if (!Object.prototype.propertyIsEnumerable.call(source, key)) continue; target[key] = source[key]; } } return target; }\n\nfunction _objectWithoutPropertiesLoose(source, excluded) { if (source == null) return {}; var target = {}; var sourceKeys = Object.keys(source); var key, i; for (i = 0; i < sourceKeys.length; i++) { key = sourceKeys[i]; if (excluded.indexOf(key) >= 0) continue; target[key] = source[key]; } return target; }\n\n/* @jsx mdx */\nvar _frontmatter = {\n  \"title\": \"Using Storybook as a Visual Testing Platform\",\n  \"author\": \"Ema Suriano\",\n  \"date\": \"2019-04-28T00:00:00.000Z\",\n  \"hero\": \"./images/hero.jpg\",\n  \"excerpt\": \"My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.\",\n  \"secret\": false\n};\n\nvar makeShortcode = function makeShortcode(name) {\n  return function MDXDefaultShortcode(props) {\n    console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\");\n    return mdx(\"div\", props);\n  };\n};\n\nvar layoutProps = {\n  _frontmatter: _frontmatter\n};\nvar MDXLayout = \"wrapper\";\nreturn function MDXContent(_ref) {\n  var components = _ref.components,\n      props = _objectWithoutProperties(_ref, [\"components\"]);\n\n  return mdx(MDXLayout, _extends({}, layoutProps, props, {\n    components: components,\n    mdxType: \"MDXLayout\"\n  }), mdx(\"p\", null, \"My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.\"), mdx(\"p\", null, \"I\\u2019ve always had visual testing in my TODO list until a few weeks ago when I finally decided to mark it as done. In this article, I am going to share my experience working with this strategy of testing (which does \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"NOT\"), \" replace the others) and the integration with my current development tool: \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://storybook.js.org/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Storybook\"), \".\"), mdx(\"p\", null, \"In case you don\\u2019t know what Storybook is, this is the definition they provide on the official website:\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"div\"\n  }, {\n    \"src\": \"/7106329c04aec4f7b83e408ab45ae948/storybook-demo.gif\",\n    \"alt\": \"Storybook Demo\"\n  })), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Storybook Demo\")), mdx(\"blockquote\", null, mdx(\"p\", {\n    parentName: \"blockquote\"\n  }, \"Storybook is an open source tool for developing UI components in isolation for React, Vue, and Angular. It makes building stunning UIs organized and efficient.\")), mdx(\"p\", null, \"Regarding \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"visual testing\"), \", it\\u2019s a testing approach that consists of taking real pictures and then compare them with the previous version. This comparison is made by comparing both pictures and checking if the pixels match.\"), mdx(\"p\", null, \"In case you already understand the concept of \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://jestjs.io/docs/en/snapshot-testing\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Snapshot Testing\"), \", this is the same. The difference is you compare a picture and not some resulting code.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2000px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"25.650000000000002%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAdOQhaC//8QAGRAAAQUAAAAAAAAAAAAAAAAAAgABEyEi/9oACAEBAAEFAo9CCYa//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAS/9oACAEDAQE/AZC//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/AaV//8QAFxABAQEBAAAAAAAAAAAAAAAAADIBMf/aAAgBAQAGPwKlO6//xAAaEAEAAgMBAAAAAAAAAAAAAAABACERUaGx/9oACAEBAAE/IRZHiOLbVSp2Z//aAAwDAQACAAMAAAAQDC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QAdLb/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EFjJ/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAITFBgf/aAAgBAQABPxAhpV5b7DmQp6DXYZz3eSf/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/70b9677641e8420594c59da9855ee5ad/56b60/visual-diff.webp 2000w\"],\n    \"sizes\": \"(max-width: 2000px) 100vw, 2000px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/70b9677641e8420594c59da9855ee5ad/9bea7/visual-diff.jpg 2000w\"],\n    \"sizes\": \"(max-width: 2000px) 100vw, 2000px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/70b9677641e8420594c59da9855ee5ad/9bea7/visual-diff.jpg\",\n    \"alt\": \"Example of Visual Testing Diff\",\n    \"title\": \"Example of Visual Testing Diff\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Example of Visual Testing Diff\")), mdx(\"p\", null, \"In case you are thinking \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201CBut how are these two concepts connected?\\u201D\"), \". Storybook insists on developing your components in isolation, which is the best scenario to do Visual Testing in order to avoid unwanted differences in our images. One way of thinking about this approach is like, \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"every story\"), \" defined in Storybook is a \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"visual test\"), \" in our application.\"), mdx(\"p\", null, \"One last thing before checking the implementation, there are excellent services out there that I tried and they work flawlessly like \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://percy.io\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Percy\"), \", \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://applitools.com/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Applitool\"), \", and many more. In this article, I want to show the \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"handmade way \"), \"of implementing a visual testing workflow, which has its own cons and pros regarding the mentioned services.\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"div\"\n  }, {\n    \"src\": \"/27a03d0809f0acb19c2cc22d69bb07a3/show-time.gif\",\n    \"alt\": \"It's Show Time\"\n  })), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"It's Show Time\")), mdx(\"p\", null, \"Let\\u2019s start with a fresh project by bootstrapping it with \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/facebook/create-react-app\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"create-react-app\"), \" and installing Storybook using its CLI.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"$ npx create-react-app visual-testing-with-storybook\\n$ cd visual-testing-with-storybook\\n$ npx -p @storybook/cli sb init\\n\")), mdx(\"p\", null, \"When the installation is finished you can check if everything was set up properly by running yarn storybook , and you should see the Homepage with two stories that were created by default.\"), mdx(\"div\", {\n    \"className\": \"Image__Large\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2226px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"46.271338724168906%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdtsKJD/xAAXEAADAQAAAAAAAAAAAAAAAAAAASAx/9oACAEBAAEFAsFP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAERIGH/2gAIAQEAAT8heh5r/9oADAMBAAIAAwAAABBjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAESFREDFB/9oACAEBAAE/ECgpZdRcWrNko1HsnnH/2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/d31ad8230763dfe5c23e305affb3a921/6b240/storybook-homepage.webp 2226w\"],\n    \"sizes\": \"(max-width: 2226px) 100vw, 2226px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/d31ad8230763dfe5c23e305affb3a921/b0746/storybook-homepage.jpg 2226w\"],\n    \"sizes\": \"(max-width: 2226px) 100vw, 2226px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/d31ad8230763dfe5c23e305affb3a921/b0746/storybook-homepage.jpg\",\n    \"alt\": \"Storybook Homepage\",\n    \"title\": \"Storybook Homepage\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Storybook Homepage\")), mdx(\"p\", null, \"Now let\\u2019s create a simple component for testing. I decided to create a simple Button called DuplicationButton , in which every time the user clicks on it the children provided by props will be duplicated. Not really useful but it will serve as a great example!\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React, { useState } from 'react';\\n\\nconst ButtonStyle = {\\n  padding: '10px',\\n  borderRadius: '5px',\\n  fontSize: '16px',\\n  border: 'pink 3px solid',\\n};\\n\\nconst DuplicationButton = ({ children }) => {\\n  const [count, setCount] = useState(1);\\n\\n  return (\\n    <button style={ButtonStyle} onClick={() => setCount(count + 1)}>\\n      {new Array(count).fill(children)}\\n    </button>\\n  );\\n};\\n\\nexport default DuplicationButton;\\n\")), mdx(\"p\", null, \"Let\\u2019s add some stories for the component.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-jsx\"\n  }), \"import React from 'react';\\nimport { storiesOf } from '@storybook/react';\\nimport DuplicationButton from './DuplicationButton';\\n\\nstoriesOf('DuplicationButton', module)\\n  .add('Good', () => (\\n    <DuplicationButton>\\n      <span role=\\\"img\\\" aria-label=\\\"angel\\\">\\n        \\uD83D\\uDE07\\n      </span>\\n    </DuplicationButton>\\n  ))\\n  .add('Bad', () => (\\n    <DuplicationButton>\\n      <span role=\\\"img\\\" aria-label=\\\"devil\\\">\\n        \\uD83D\\uDE08\\n      </span>\\n    </DuplicationButton>\\n  ));\\n\")), mdx(\"p\", null, \"And this is how it looks in Storybook.\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"div\"\n  }, {\n    \"src\": \"/e05ddef73c0af2952f611e1ed71a6dc1/duplication-button.gif\",\n    \"alt\": \"Demo DuplicationButton stories\"\n  })), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Demo DuplicationButton stories\")), mdx(\"h2\", {\n    \"id\": \"generating-tests-based-on-stories-üß™\"\n  }, \"Generating tests based on stories \\uD83E\\uDDEA\"), mdx(\"p\", null, \"In order to implement one test per story, there is a really helpful add-on in Storybook called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.npmjs.com/package/@storybook/addon-storyshots\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"storyshots\"), \". In order to install it, you need to run:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"$ yarn add -D @storybook/addon-storyshots react-test-renderer\\n\")), mdx(\"p\", null, \"Then create a test file where you initialize \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storyshots\"), \". Let\\u2019s name it \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"storyshots.test.js\"), \".\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// src/storyshots.test.js**\\nimport** initStoryshots **from** '@storybook/addon-storyshots';\\n\\ninitStoryshots({ */* configuration options */* });\\n\")), mdx(\"p\", null, \"In order to run it, execute yarn test. Now for each story, there is a test with a \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"snapshot\"), \" where you can check what is the output (component rendered) of the story. These \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"snapshots\"), \" are going to be automatically generated every time we run our tests, and in case they have a difference with the previous one the test will fail.\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1008px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"53.37301587301587%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABy6DUgH//xAAVEAEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQJa/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAASD/2gAIAQEABj8Ca//EABkQAQACAwAAAAAAAAAAAAAAAAEQEQAhQf/aAAgBAQABPyFm177jDP8A/9oADAMBAAIAAwAAABAr7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAwEBAAAAAAAAAAAAAAERIQAQMVGR/9oACAEBAAE/EA27S2LXKLelPnzHhr//2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/1aca6424eb36aa2f94f926f573d55911/de9ce/result-storyshots.webp 1008w\"],\n    \"sizes\": \"(max-width: 1008px) 100vw, 1008px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/1aca6424eb36aa2f94f926f573d55911/c6fcc/result-storyshots.jpg 1008w\"],\n    \"sizes\": \"(max-width: 1008px) 100vw, 1008px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/1aca6424eb36aa2f94f926f573d55911/c6fcc/result-storyshots.jpg\",\n    \"alt\": \"Test result with storyshots\",\n    \"title\": \"Test result with storyshots\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Test result with storyshots\")), mdx(\"h2\", {\n    \"id\": \"lets-get-visual-\"\n  }, \"Let\\u2019s get Visual! \\uD83C\\uDF08\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"div\"\n  }, {\n    \"src\": \"/cd5d845a84d735ffff37590bf2e9d06a/visual-illusion.gif\",\n    \"alt\": \"Visual Illusion\"\n  })), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Visual Illusion\")), mdx(\"p\", null, \"In the code from above, the function initStoryshots accepts a configuration object with an option called test that allows us to change the comparison method for each story/test.\"), mdx(\"p\", null, \"Luckily, there is an add-on called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.npmjs.com/package/@storybook/addon-storyshots-puppeteer\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"storyshot-puppeteer\"), \" , which as the name state creates an instance of a browser, navigates to the story, takes a picture and compares it with the previous one! In order to install it:\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"$ yarn add -D @storybook/addon-storyshots-puppeteer\\n\")), mdx(\"p\", null, \"Then inside the storyshots file, you need to override the test comparison with imageSnapshot from the puppeteer add-on. Also, it\\u2019s needed to specify the URL where storybook will be running in order to know where to navigate.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// src/storyshots.test.js\\nimport initStoryshots from '[@storybook/addon-storyshots](http://twitter.com/storybook/addon-storyshots)';\\nimport { imageSnapshot } from '[@storybook/addon-storyshots-puppetee](http://twitter.com/storybook/addon-storyshots-puppetee)r';\\n\\ninitStoryshots({\\n  test: imageSnapshot({ storybookUrl: '[http://localhost:9009/'](http://localhost:9009/') }),\\n});\\n\")), mdx(\"p\", null, \"One thing to mention is that now our tests depends on having an instance of storybook running. I recommend managing two terminals at the same time for this kind of scenarios: in one terminal you run yarn storybook and in another yarn test .\"), mdx(\"div\", {\n    \"className\": \"Image__Large\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2292px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"43.97905759162304%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAcd1Z+iYBf/EABgQAAMBAQAAAAAAAAAAAAAAAAABAjIQ/9oACAEBAAEFAmyc8nJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAQITFB/9oACAEBAAE/IUeseN6q/9oADAMBAAIAAwAAABBUP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAbEAACAQUAAAAAAAAAAAAAAAABEAARITFRwf/aAAgBAQABPxAB1lnrtHJY/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/a0d3f/visual-testing-storyshots.webp 2292w\"],\n    \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg 2292w\"],\n    \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg\",\n    \"alt\": \"Running visual testing along with Storybook\",\n    \"title\": \"Running visual testing along with Storybook\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Running visual testing along with Storybook\")), mdx(\"p\", null, \"The old snapshots are obsolete (you can safely delete them) because now we have a new folder called \", mdx(\"strong\", {\n    parentName: \"p\"\n  }, \"image_snapshots\"), \" where there is a picture for each story. And every time a component changes what it renders, tests will fail and you can check it with a visual diffing between the stored image snapshot and the new image.\"), mdx(\"p\", null, \"In the following diffing I changed the border-color of the button from pink to blue. The original image will be on the left, the new on the right and in the middle the difference between both with the changes in red color.\"), mdx(\"div\", {\n    \"className\": \"Image__Large\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"2292px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"43.97905759162304%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAcd1Z+iYBf/EABgQAAMBAQAAAAAAAAAAAAAAAAABAjIQ/9oACAEBAAEFAmyc8nJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAQITFB/9oACAEBAAE/IUeseN6q/9oADAMBAAIAAwAAABBUP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAbEAACAQUAAAAAAAAAAAAAAAABEAARITFRwf/aAAgBAQABPxAB1lnrtHJY/9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/a0d3f/visual-testing-storyshots.webp 2292w\"],\n    \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg 2292w\"],\n    \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg\",\n    \"alt\": \"Visual diffing in action\",\n    \"title\": \"Visual diffing in action\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Visual diffing in action\")), mdx(\"h2\", {\n    \"id\": \"running-on-ci-Ô∏è\"\n  }, \"Running on CI \\u2699\\uFE0F\"), mdx(\"p\", null, \"Having two terminal opened at the same time it\\u2019s something that we can only do in development. But when it comes to automatize this task, things can be a little bit tricky.\"), mdx(\"p\", null, \"Luckily someone thought about this problem and made an npm package, called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/bahmutov/start-server-and-test\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"start-server-and-test\"), \" which does exactly that! You need to specify the command to \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201Cstart the server\\u201D\"), \", once the server is up and running, it will the command of \", mdx(\"em\", {\n    parentName: \"p\"\n  }, \"\\u201Ctest\\u201D\"), \" that you specified and once that process is done it will kill the server.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"yarn add start-server-and-test\\n\")), mdx(\"p\", null, \"Inside package.json , you need to create a new script which will start storybook, then listen until \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"http://localhost:9009\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"http://localhost:9009\"), \" is up and running and execute the tests.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-json\"\n  }), \"\\\"scripts\\\": {\\n  \\\"test\\\": \\\"react-scripts test --coverage\\\",\\n  \\\"storybook\\\": \\\"start-storybook -p 9009 -s public\\\",\\n  \\\"test:ci\\\": \\\"start-server-and-test storybook [http://localhost:9009](http://localhost:9009) test\\\",\\n},\\n\")), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1132px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"20.141342756183747%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAByomyoF//xAAXEAEAAwAAAAAAAAAAAAAAAAABABAR/9oACAEBAAEFAtYq1//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMRD/2gAIAQEABj8CrLn/xAAaEAEAAQUAAAAAAAAAAAAAAAABEQAQIVHR/9oACAEBAAE/IZ+1EZTG23//2gAMAwEAAgADAAAAEPPv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERUZH/2gAIAQEAAT8Qb0fQMOUo4U//2Q==')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/876897c6e0fb7f2ab156f35907c5cd54/8331a/ci-output.webp 1132w\"],\n    \"sizes\": \"(max-width: 1132px) 100vw, 1132px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/876897c6e0fb7f2ab156f35907c5cd54/66ab7/ci-output.jpg 1132w\"],\n    \"sizes\": \"(max-width: 1132px) 100vw, 1132px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/876897c6e0fb7f2ab156f35907c5cd54/66ab7/ci-output.jpg\",\n    \"alt\": \"Test CI output\",\n    \"title\": \"Test CI output\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Test CI output\")), mdx(\"h2\", {\n    \"id\": \"interactive-visual-testing-üï∫\"\n  }, \"Interactive Visual Testing \\uD83D\\uDD7A\"), mdx(\"p\", null, \"Sometimes you would like to interact with the story before taking the picture. In order to do that, you need to follow a different approach than the previously showed. You can achieve this by using a customer jest matcher called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/americanexpress/jest-image-snapshot\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"jest-image-snapshot\"), \" , and any end-to-end framework. In this case, picked \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/GoogleChrome/puppeteer\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"puppeteer\"), \" .\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-bash\"\n  }), \"yarn add -D jest-image-snapshot puppeteer\\n\")), mdx(\"p\", null, \"In order to enable jest-image-snapshot, you need to extend the function expect from jest . The \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"recommended way\"), \" of achieving this with create-react-app is by creating a file inside src with the name of setupTests.js . This file will be loaded before all the tests started, which will enable us to use this custom matcher.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// src/setupTests.js\\nimport { toMatchImageSnapshot } from 'jest-image-snapshot';\\n\\nexpect.extend({ toMatchImageSnapshot });\\n\")), mdx(\"p\", null, \"Then create the test file when we are going to check the behavior of DuplicationButton, let\\u2019s check how it looks when the user clicks on it twice.\"), mdx(\"pre\", null, mdx(\"code\", _extends({\n    parentName: \"pre\"\n  }, {\n    \"className\": \"language-javascript\"\n  }), \"// src/DuplicationButton.test.js\\nimport puppeteer from 'puppeteer';\\n\\ndescribe('<DuplicationButton />', () => {\\n  let page;\\n\\n  beforeAll(async () => {\\n    // init puppeteer page\\n    let browser = await puppeteer.launch();\\n    page = await browser.newPage();\\n  });\\n\\n  it('should duplicate content after clicking', async () => {\\n    // navigate to fullscreen story\\n    await page.goto(\\n      '[http://localhost:9009/iframe.html?id=duplicationbutton--good'](http://localhost:9009/iframe.html?id=duplicationbutton--good'),\\n    );\\n\\n    // click on the button\\n    await page.click('button');\\n\\n    // take screenshot and compare\\n    const screenshot = await page.screenshot();\\n    expect(screenshot).toMatchImageSnapshot();\\n  });\\n});\\n\")), mdx(\"p\", null, \"In order to run this test, we need to start Storybook or you can directly use yarn test:ci which will do it for you! This is how the screenshot looks like:\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"800px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"75%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB36AH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFRABAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQEAAT8hi//aAAwDAQACAAMAAAAQgA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAWEAEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQEAAT8QAECGv//Z')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b0c9893d84a8ac70842fbabe0a35eff7/8d2ea/interactive-testing.webp 800w\"],\n    \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/b0c9893d84a8ac70842fbabe0a35eff7/c60e9/interactive-testing.jpg 800w\"],\n    \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/b0c9893d84a8ac70842fbabe0a35eff7/c60e9/interactive-testing.jpg\",\n    \"alt\": \"Interactive visual testing\",\n    \"title\": \"Interactive visual testing\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Interactive visual testing\")), mdx(\"h2\", {\n    \"id\": \"my-experience-working-with-visual-testing-‚ôÇÔ∏è\"\n  }, \"My Experience working with Visual Testing \\uD83D\\uDE4B\\u200D\\u2642\\uFE0F\"), mdx(\"p\", null, \"As with all the new technologies/frameworks, I tried Visual testing first with a side project in which I saw a possible improvement. The project itself was a collection of weather icons made with React and \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://www.styled-components.com/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"styled-components\"), \", called \", mdx(\"a\", _extends({\n    parentName: \"p\"\n  }, {\n    \"href\": \"https://github.com/EmaSuriano/weather-styled-icon\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"weather-styled-icon\"), \".\"), mdx(\"div\", {\n    \"className\": \"Image__Small\"\n  }, \"\\n  \", mdx(\"img\", _extends({\n    parentName: \"div\"\n  }, {\n    \"src\": \"/edea83629587102745ea8e81f071a5fa/weather-styled-icon.gif\",\n    \"alt\": \"weather-styled-icon showcase\"\n  })), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"weather-styled-icon showcase\")), mdx(\"p\", null, \"The first release I made of this library I wrote all the tests with enzyme, following a structural testing strategy. In simple words, I was rendering an icon with mount and then running checking if a node exists, and in order to check how it \\u201Clooks\\u201D I was running \", mdx(\"inlineCode\", {\n    parentName: \"p\"\n  }, \"expect.toMatchSnapshot\"), \" of the resulting styles. As you can imagine, this way of testing is very time consuming, but nevertheless, I was able to finish all of them.\"), mdx(\"p\", null, \"The problem came when I decided to update the version of styled-components from v3 to v4 because I wanted to start using some of the cool new APIs, like ThemeProvider or the styledAPI to style existing styled-component components.\"), mdx(\"p\", null, \"After I made all the changes inside the code, all my tests were broken due to I moved, added and removed components, also I changed the internal implementation of mostly all of them. At this point, I realized I was testing the implementation of my components and not the really the output I was expecting.\"), mdx(\"p\", null, \"So I made the decision to give a try to Visual Testing because it seemed the most suitable testing strategy for my situation, where I want to check exactly how the icons and them variations looked like. I followed the same steps that I already explained above and I ended up having a better suite of tests with way less code. This is the difference of lines of the merged Pull Request!\"), mdx(\"div\", {\n    \"className\": \"Image__Medium\"\n  }, \"\\n  \", mdx(\"span\", _extends({\n    parentName: \"div\"\n  }, {\n    \"className\": \"gatsby-resp-image-wrapper\",\n    \"style\": {\n      \"position\": \"relative\",\n      \"display\": \"block\",\n      \"marginLeft\": \"auto\",\n      \"marginRight\": \"auto\",\n      \"maxWidth\": \"1984px\"\n    }\n  }), \"\\n      \", mdx(\"span\", _extends({\n    parentName: \"span\"\n  }, {\n    \"className\": \"gatsby-resp-image-background-image\",\n    \"style\": {\n      \"paddingBottom\": \"26.108870967741936%\",\n      \"position\": \"relative\",\n      \"bottom\": \"0\",\n      \"left\": \"0\",\n      \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdygkS//xAAWEAADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCVP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABoQAQABBQAAAAAAAAAAAAAAAAEAEBEhMVH/2gAIAQEAAT8hDrejlqf/2gAMAwEAAgADAAAAEPPf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EGR//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QV//EABkQAQACAwAAAAAAAAAAAAAAAAEAETFBUf/aAAgBAQABPxBykEcKgDnUAQR//9k=')\",\n      \"backgroundSize\": \"cover\",\n      \"display\": \"block\"\n    }\n  })), \"\\n  \", mdx(\"picture\", {\n    parentName: \"span\"\n  }, \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/4ac54b8ec14fa1a059df048210fd729d/78dfe/pr-diff.webp 1984w\"],\n    \"sizes\": \"(max-width: 1984px) 100vw, 1984px\",\n    \"type\": \"image/webp\"\n  })), \"\\n        \", mdx(\"source\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"srcSet\": [\"/static/4ac54b8ec14fa1a059df048210fd729d/0ae08/pr-diff.jpg 1984w\"],\n    \"sizes\": \"(max-width: 1984px) 100vw, 1984px\",\n    \"type\": \"image/jpeg\"\n  })), \"\\n        \", mdx(\"img\", _extends({\n    parentName: \"picture\"\n  }, {\n    \"className\": \"gatsby-resp-image-image\",\n    \"src\": \"/static/4ac54b8ec14fa1a059df048210fd729d/0ae08/pr-diff.jpg\",\n    \"alt\": \"Visual testing lines diff weather-styled-icon\",\n    \"title\": \"Visual testing lines diff weather-styled-icon\",\n    \"loading\": \"lazy\",\n    \"style\": {\n      \"width\": \"100%\",\n      \"height\": \"100%\",\n      \"margin\": \"0\",\n      \"verticalAlign\": \"middle\",\n      \"position\": \"absolute\",\n      \"top\": \"0\",\n      \"left\": \"0\"\n    }\n  })), \"\\n      \"), \"\\n    \"), \"\\n  \", mdx(\"figcaption\", {\n    parentName: \"div\"\n  }, \"Visual testing lines diff weather-styled-icon\")), mdx(\"h2\", {\n    \"id\": \"dos-and-donts-Ô∏è\"\n  }, \"Do\\u2019s and Dont\\u2019s \\u270D\\uFE0F\"), mdx(\"p\", null, \"I think Visual Testing is an excellent way of testing and I highly encourage you to at least try it in a side project where you can play with it and see if you like it or not. However, I would like to highlight a few important things to do and NOT to do regarding this topic:\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u274C Don\\u2019t check the styles of your components with code, instead, take a real image of the component.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u2705 In case you are using Storybook in your development workflow, you can have one visual test for all the stories without any real effort.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u274C Visual testing does NOT replace other strategies of testing, it just adds another testing layer to your application.\"), mdx(\"li\", {\n    parentName: \"ul\"\n  }, \"\\u2705 You can easily integrate it with your current end-to-end tests.\")), mdx(\"h2\", {\n    \"id\": \"helpful-resources-\"\n  }, \"Helpful Resources \\uD83D\\uDCD3\"), mdx(\"ul\", null, mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/EmaSuriano/visual-testing-storybook\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Link to the sample project\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://github.com/EmaSuriano/weather-styled-icon\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"weather-styled-icon\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://storybook.js.org/docs/testing/automated-visual-testing/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Automated Visual Testing \\u2014 Storybook Documentation\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://jestjs.io/docs/en/puppeteer\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Puppeteer with Jest\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://storybook.js.org/docs/testing/structural-testing/\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Structural Testing \\u2014 Storybook Documentation\")), mdx(\"li\", {\n    parentName: \"ul\"\n  }, mdx(\"a\", _extends({\n    parentName: \"li\"\n  }, {\n    \"href\": \"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs\",\n    \"target\": \"_blank\",\n    \"rel\": \"noreferrer\"\n  }), \"Extending Jest config in create-react-app\"))));\n}\n;\nMDXContent.isMDXComponent = true;","rawMDXOutput":"/* @jsx mdx */\nimport { mdx } from '@mdx-js/react';\n/* @jsx mdx */\n\nexport const _frontmatter = {\n  \"title\": \"Using Storybook as a Visual Testing Platform\",\n  \"author\": \"Ema Suriano\",\n  \"date\": \"2019-04-28T00:00:00.000Z\",\n  \"hero\": \"./images/hero.jpg\",\n  \"excerpt\": \"My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.\",\n  \"secret\": false\n};\nconst makeShortcode = name => function MDXDefaultShortcode(props) {\n  console.warn(\"Component \" + name + \" was not imported, exported, or provided by MDXProvider as global scope\")\n  return <div {...props}/>\n};\n\nconst layoutProps = {\n  _frontmatter\n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <p>{`My experience working with this strategy of testing (which does not replace the others) and the integration with my current development tool.`}</p>\n    <p>{`I‚Äôve always had visual testing in my TODO list until a few weeks ago when I finally decided to mark it as done. In this article, I am going to share my experience working with this strategy of testing (which does `}<strong parentName=\"p\">{`NOT`}</strong>{` replace the others) and the integration with my current development tool: `}<a parentName=\"p\" {...{\n        \"href\": \"https://storybook.js.org/\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`Storybook`}</a>{`.`}</p>\n    <p>{`In case you don‚Äôt know what Storybook is, this is the definition they provide on the official website:`}</p>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<img parentName=\"div\" {...{\n        \"src\": \"/7106329c04aec4f7b83e408ab45ae948/storybook-demo.gif\",\n        \"alt\": \"Storybook Demo\"\n      }}></img>{`\n  `}<figcaption parentName=\"div\">{`Storybook Demo`}</figcaption>\n    </div>\n    <blockquote>\n      <p parentName=\"blockquote\">{`Storybook is an open source tool for developing UI components in isolation for React, Vue, and Angular. It makes building stunning UIs organized and efficient.`}</p>\n    </blockquote>\n    <p>{`Regarding `}<strong parentName=\"p\">{`visual testing`}</strong>{`, it‚Äôs a testing approach that consists of taking real pictures and then compare them with the previous version. This comparison is made by comparing both pictures and checking if the pixels match.`}</p>\n    <p>{`In case you already understand the concept of `}<a parentName=\"p\" {...{\n        \"href\": \"https://jestjs.io/docs/en/snapshot-testing\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`Snapshot Testing`}</a>{`, this is the same. The difference is you compare a picture and not some resulting code.`}</p>\n    <div {...{\n      \"className\": \"Image__Medium\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"2000px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"25.650000000000002%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABQBAQAAAAAAAAAAAAAAAAAAAAL/2gAMAwEAAhADEAAAAdOQhaC//8QAGRAAAQUAAAAAAAAAAAAAAAAAAgABEyEi/9oACAEBAAEFAo9CCYa//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAS/9oACAEDAQE/AZC//8QAFhEAAwAAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/AaV//8QAFxABAQEBAAAAAAAAAAAAAAAAADIBMf/aAAgBAQAGPwKlO6//xAAaEAEAAgMBAAAAAAAAAAAAAAABACERUaGx/9oACAEBAAE/IRZHiOLbVSp2Z//aAAwDAQACAAMAAAAQDC//xAAWEQEBAQAAAAAAAAAAAAAAAAABABH/2gAIAQMBAT8QAdLb/8QAFhEBAQEAAAAAAAAAAAAAAAAAARAR/9oACAECAQE/EFjJ/8QAGhAAAgIDAAAAAAAAAAAAAAAAAREAITFBgf/aAAgBAQABPxAhpV5b7DmQp6DXYZz3eSf/2Q==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/70b9677641e8420594c59da9855ee5ad/56b60/visual-diff.webp 2000w\"],\n            \"sizes\": \"(max-width: 2000px) 100vw, 2000px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/70b9677641e8420594c59da9855ee5ad/9bea7/visual-diff.jpg 2000w\"],\n            \"sizes\": \"(max-width: 2000px) 100vw, 2000px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/70b9677641e8420594c59da9855ee5ad/9bea7/visual-diff.jpg\",\n            \"alt\": \"Example of Visual Testing Diff\",\n            \"title\": \"Example of Visual Testing Diff\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Example of Visual Testing Diff`}</figcaption>\n    </div>\n    <p>{`In case you are thinking `}<em parentName=\"p\">{`‚ÄúBut how are these two concepts connected?‚Äù`}</em>{`. Storybook insists on developing your components in isolation, which is the best scenario to do Visual Testing in order to avoid unwanted differences in our images. One way of thinking about this approach is like, `}<strong parentName=\"p\">{`every story`}</strong>{` defined in Storybook is a `}<strong parentName=\"p\">{`visual test`}</strong>{` in our application.`}</p>\n    <p>{`One last thing before checking the implementation, there are excellent services out there that I tried and they work flawlessly like `}<a parentName=\"p\" {...{\n        \"href\": \"https://percy.io\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`Percy`}</a>{`, `}<a parentName=\"p\" {...{\n        \"href\": \"https://applitools.com/\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`Applitool`}</a>{`, and many more. In this article, I want to show the `}<em parentName=\"p\">{`handmade way `}</em>{`of implementing a visual testing workflow, which has its own cons and pros regarding the mentioned services.`}</p>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<img parentName=\"div\" {...{\n        \"src\": \"/27a03d0809f0acb19c2cc22d69bb07a3/show-time.gif\",\n        \"alt\": \"It's Show Time\"\n      }}></img>{`\n  `}<figcaption parentName=\"div\">{`It's Show Time`}</figcaption>\n    </div>\n    <p>{`Let‚Äôs start with a fresh project by bootstrapping it with `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/facebook/create-react-app\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`create-react-app`}</a>{` and installing Storybook using its CLI.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ npx create-react-app visual-testing-with-storybook\n$ cd visual-testing-with-storybook\n$ npx -p @storybook/cli sb init\n`}</code></pre>\n    <p>{`When the installation is finished you can check if everything was set up properly by running yarn storybook , and you should see the Homepage with two stories that were created by default.`}</p>\n    <div {...{\n      \"className\": \"Image__Large\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"2226px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"46.271338724168906%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAFwAAAwEAAAAAAAAAAAAAAAAAAAECBf/EABQBAQAAAAAAAAAAAAAAAAAAAAD/2gAMAwEAAhADEAAAAdtsKJD/xAAXEAADAQAAAAAAAAAAAAAAAAAAASAx/9oACAEBAAEFAsFP/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGBAAAgMAAAAAAAAAAAAAAAAAAAERIGH/2gAIAQEAAT8heh5r/9oADAMBAAIAAwAAABBjD//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAgMAAAAAAAAAAAAAAAEAESFREDFB/9oACAEBAAE/ECgpZdRcWrNko1HsnnH/2Q==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/d31ad8230763dfe5c23e305affb3a921/6b240/storybook-homepage.webp 2226w\"],\n            \"sizes\": \"(max-width: 2226px) 100vw, 2226px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/d31ad8230763dfe5c23e305affb3a921/b0746/storybook-homepage.jpg 2226w\"],\n            \"sizes\": \"(max-width: 2226px) 100vw, 2226px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/d31ad8230763dfe5c23e305affb3a921/b0746/storybook-homepage.jpg\",\n            \"alt\": \"Storybook Homepage\",\n            \"title\": \"Storybook Homepage\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Storybook Homepage`}</figcaption>\n    </div>\n    <p>{`Now let‚Äôs create a simple component for testing. I decided to create a simple Button called DuplicationButton , in which every time the user clicks on it the children provided by props will be duplicated. Not really useful but it will serve as a great example!`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import React, { useState } from 'react';\n\nconst ButtonStyle = {\n  padding: '10px',\n  borderRadius: '5px',\n  fontSize: '16px',\n  border: 'pink 3px solid',\n};\n\nconst DuplicationButton = ({ children }) => {\n  const [count, setCount] = useState(1);\n\n  return (\n    <button style={ButtonStyle} onClick={() => setCount(count + 1)}>\n      {new Array(count).fill(children)}\n    </button>\n  );\n};\n\nexport default DuplicationButton;\n`}</code></pre>\n    <p>{`Let‚Äôs add some stories for the component.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-jsx\"\n      }}>{`import React from 'react';\nimport { storiesOf } from '@storybook/react';\nimport DuplicationButton from './DuplicationButton';\n\nstoriesOf('DuplicationButton', module)\n  .add('Good', () => (\n    <DuplicationButton>\n      <span role=\"img\" aria-label=\"angel\">\n        üòá\n      </span>\n    </DuplicationButton>\n  ))\n  .add('Bad', () => (\n    <DuplicationButton>\n      <span role=\"img\" aria-label=\"devil\">\n        üòà\n      </span>\n    </DuplicationButton>\n  ));\n`}</code></pre>\n    <p>{`And this is how it looks in Storybook.`}</p>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<img parentName=\"div\" {...{\n        \"src\": \"/e05ddef73c0af2952f611e1ed71a6dc1/duplication-button.gif\",\n        \"alt\": \"Demo DuplicationButton stories\"\n      }}></img>{`\n  `}<figcaption parentName=\"div\">{`Demo DuplicationButton stories`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"generating-tests-based-on-stories-üß™\"\n    }}>{`Generating tests based on stories üß™`}</h2>\n    <p>{`In order to implement one test per story, there is a really helpful add-on in Storybook called `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.npmjs.com/package/@storybook/addon-storyshots\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`storyshots`}</a>{`. In order to install it, you need to run:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ yarn add -D @storybook/addon-storyshots react-test-renderer\n`}</code></pre>\n    <p>{`Then create a test file where you initialize `}<inlineCode parentName=\"p\">{`storyshots`}</inlineCode>{`. Let‚Äôs name it `}<inlineCode parentName=\"p\">{`storyshots.test.js`}</inlineCode>{`.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`// src/storyshots.test.js**\nimport** initStoryshots **from** '@storybook/addon-storyshots';\n\ninitStoryshots({ */* configuration options */* });\n`}</code></pre>\n    <p>{`In order to run it, execute yarn test. Now for each story, there is a test with a `}<em parentName=\"p\">{`snapshot`}</em>{` where you can check what is the output (component rendered) of the story. These `}<em parentName=\"p\">{`snapshots`}</em>{` are going to be automatically generated every time we run our tests, and in case they have a difference with the previous one the test will fail.`}</p>\n    <div {...{\n      \"className\": \"Image__Medium\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1008px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"53.37301587301587%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAALABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAEDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAABAv/aAAwDAQACEAMQAAABy6DUgH//xAAVEAEBAAAAAAAAAAAAAAAAAAABIP/aAAgBAQABBQJa/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFRABAQAAAAAAAAAAAAAAAAAAASD/2gAIAQEABj8Ca//EABkQAQACAwAAAAAAAAAAAAAAAAEQEQAhQf/aAAgBAQABPyFm177jDP8A/9oADAMBAAIAAwAAABAr7//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8QP//EABsQAQACAwEBAAAAAAAAAAAAAAERIQAQMVGR/9oACAEBAAE/EA27S2LXKLelPnzHhr//2Q==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/1aca6424eb36aa2f94f926f573d55911/de9ce/result-storyshots.webp 1008w\"],\n            \"sizes\": \"(max-width: 1008px) 100vw, 1008px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/1aca6424eb36aa2f94f926f573d55911/c6fcc/result-storyshots.jpg 1008w\"],\n            \"sizes\": \"(max-width: 1008px) 100vw, 1008px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/1aca6424eb36aa2f94f926f573d55911/c6fcc/result-storyshots.jpg\",\n            \"alt\": \"Test result with storyshots\",\n            \"title\": \"Test result with storyshots\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Test result with storyshots`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"lets-get-visual-\"\n    }}>{`Let‚Äôs get Visual! üåà`}</h2>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<img parentName=\"div\" {...{\n        \"src\": \"/cd5d845a84d735ffff37590bf2e9d06a/visual-illusion.gif\",\n        \"alt\": \"Visual Illusion\"\n      }}></img>{`\n  `}<figcaption parentName=\"div\">{`Visual Illusion`}</figcaption>\n    </div>\n    <p>{`In the code from above, the function initStoryshots accepts a configuration object with an option called test that allows us to change the comparison method for each story/test.`}</p>\n    <p>{`Luckily, there is an add-on called `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.npmjs.com/package/@storybook/addon-storyshots-puppeteer\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`storyshot-puppeteer`}</a>{` , which as the name state creates an instance of a browser, navigates to the story, takes a picture and compares it with the previous one! In order to install it:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`$ yarn add -D @storybook/addon-storyshots-puppeteer\n`}</code></pre>\n    <p>{`Then inside the storyshots file, you need to override the test comparison with imageSnapshot from the puppeteer add-on. Also, it‚Äôs needed to specify the URL where storybook will be running in order to know where to navigate.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`// src/storyshots.test.js\nimport initStoryshots from '[@storybook/addon-storyshots](http://twitter.com/storybook/addon-storyshots)';\nimport { imageSnapshot } from '[@storybook/addon-storyshots-puppetee](http://twitter.com/storybook/addon-storyshots-puppetee)r';\n\ninitStoryshots({\n  test: imageSnapshot({ storybookUrl: '[http://localhost:9009/'](http://localhost:9009/') }),\n});\n`}</code></pre>\n    <p>{`One thing to mention is that now our tests depends on having an instance of storybook running. I recommend managing two terminals at the same time for this kind of scenarios: in one terminal you run yarn storybook and in another yarn test .`}</p>\n    <div {...{\n      \"className\": \"Image__Large\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"2292px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"43.97905759162304%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAcd1Z+iYBf/EABgQAAMBAQAAAAAAAAAAAAAAAAABAjIQ/9oACAEBAAEFAmyc8nJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAQITFB/9oACAEBAAE/IUeseN6q/9oADAMBAAIAAwAAABBUP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAbEAACAQUAAAAAAAAAAAAAAAABEAARITFRwf/aAAgBAQABPxAB1lnrtHJY/9k=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/a0d3f/visual-testing-storyshots.webp 2292w\"],\n            \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg 2292w\"],\n            \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg\",\n            \"alt\": \"Running visual testing along with Storybook\",\n            \"title\": \"Running visual testing along with Storybook\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Running visual testing along with Storybook`}</figcaption>\n    </div>\n    <p>{`The old snapshots are obsolete (you can safely delete them) because now we have a new folder called `}<strong parentName=\"p\">{`image_snapshots`}</strong>{` where there is a picture for each story. And every time a component changes what it renders, tests will fail and you can check it with a visual diffing between the stored image snapshot and the new image.`}</p>\n    <p>{`In the following diffing I changed the border-color of the button from pink to blue. The original image will be on the left, the new on the right and in the middle the difference between both with the changes in red color.`}</p>\n    <div {...{\n      \"className\": \"Image__Large\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"2292px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"43.97905759162304%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAJABQDASIAAhEBAxEB/8QAGAAAAgMAAAAAAAAAAAAAAAAAAAMCBAX/xAAWAQEBAQAAAAAAAAAAAAAAAAABAAL/2gAMAwEAAhADEAAAAcd1Z+iYBf/EABgQAAMBAQAAAAAAAAAAAAAAAAABAjIQ/9oACAEBAAEFAmyc8nJ//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAGRABAAIDAAAAAAAAAAAAAAAAAQAQITFB/9oACAEBAAE/IUeseN6q/9oADAMBAAIAAwAAABBUP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8QP//EABURAQEAAAAAAAAAAAAAAAAAAAEQ/9oACAECAQE/EGf/xAAbEAACAQUAAAAAAAAAAAAAAAABEAARITFRwf/aAAgBAQABPxAB1lnrtHJY/9k=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/a0d3f/visual-testing-storyshots.webp 2292w\"],\n            \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg 2292w\"],\n            \"sizes\": \"(max-width: 2292px) 100vw, 2292px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/84a408b118af15351f5e23e456bcc1c3/d311c/visual-testing-storyshots.jpg\",\n            \"alt\": \"Visual diffing in action\",\n            \"title\": \"Visual diffing in action\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Visual diffing in action`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"running-on-ci-Ô∏è\"\n    }}>{`Running on CI ‚öôÔ∏è`}</h2>\n    <p>{`Having two terminal opened at the same time it‚Äôs something that we can only do in development. But when it comes to automatize this task, things can be a little bit tricky.`}</p>\n    <p>{`Luckily someone thought about this problem and made an npm package, called `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/bahmutov/start-server-and-test\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`start-server-and-test`}</a>{` which does exactly that! You need to specify the command to `}<em parentName=\"p\">{`‚Äústart the server‚Äù`}</em>{`, once the server is up and running, it will the command of `}<em parentName=\"p\">{`‚Äútest‚Äù`}</em>{` that you specified and once that process is done it will kill the server.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`yarn add start-server-and-test\n`}</code></pre>\n    <p>{`Inside package.json , you need to create a new script which will start storybook, then listen until `}<a parentName=\"p\" {...{\n        \"href\": \"http://localhost:9009\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`http://localhost:9009`}</a>{` is up and running and execute the tests.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`\"scripts\": {\n  \"test\": \"react-scripts test --coverage\",\n  \"storybook\": \"start-storybook -p 9009 -s public\",\n  \"test:ci\": \"start-server-and-test storybook [http://localhost:9009](http://localhost:9009) test\",\n},\n`}</code></pre>\n    <div {...{\n      \"className\": \"Image__Medium\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1132px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"20.141342756183747%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAEABQDASIAAhEBAxEB/8QAFwABAAMAAAAAAAAAAAAAAAAAAAIDBf/EABYBAQEBAAAAAAAAAAAAAAAAAAEAAv/aAAwDAQACEAMQAAAByomyoF//xAAXEAEAAwAAAAAAAAAAAAAAAAABABAR/9oACAEBAAEFAtYq1//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABcQAAMBAAAAAAAAAAAAAAAAAAABMRD/2gAIAQEABj8CrLn/xAAaEAEAAQUAAAAAAAAAAAAAAAABEQAQIVHR/9oACAEBAAE/IZ+1EZTG23//2gAMAwEAAgADAAAAEPPv/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPxA//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPxA//8QAGBAAAwEBAAAAAAAAAAAAAAAAAAERUZH/2gAIAQEAAT8Qb0fQMOUo4U//2Q==')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/876897c6e0fb7f2ab156f35907c5cd54/8331a/ci-output.webp 1132w\"],\n            \"sizes\": \"(max-width: 1132px) 100vw, 1132px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/876897c6e0fb7f2ab156f35907c5cd54/66ab7/ci-output.jpg 1132w\"],\n            \"sizes\": \"(max-width: 1132px) 100vw, 1132px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/876897c6e0fb7f2ab156f35907c5cd54/66ab7/ci-output.jpg\",\n            \"alt\": \"Test CI output\",\n            \"title\": \"Test CI output\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Test CI output`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"interactive-visual-testing-üï∫\"\n    }}>{`Interactive Visual Testing üï∫`}</h2>\n    <p>{`Sometimes you would like to interact with the story before taking the picture. In order to do that, you need to follow a different approach than the previously showed. You can achieve this by using a customer jest matcher called `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/americanexpress/jest-image-snapshot\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`jest-image-snapshot`}</a>{` , and any end-to-end framework. In this case, picked `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/GoogleChrome/puppeteer\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`puppeteer`}</a>{` .`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`yarn add -D jest-image-snapshot puppeteer\n`}</code></pre>\n    <p>{`In order to enable jest-image-snapshot, you need to extend the function expect from jest . The `}<a parentName=\"p\" {...{\n        \"href\": \"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`recommended way`}</a>{` of achieving this with create-react-app is by creating a file inside src with the name of setupTests.js . This file will be loaded before all the tests started, which will enable us to use this custom matcher.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`// src/setupTests.js\nimport { toMatchImageSnapshot } from 'jest-image-snapshot';\n\nexpect.extend({ toMatchImageSnapshot });\n`}</code></pre>\n    <p>{`Then create the test file when we are going to check the behavior of DuplicationButton, let‚Äôs check how it looks when the user clicks on it twice.`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-javascript\"\n      }}>{`// src/DuplicationButton.test.js\nimport puppeteer from 'puppeteer';\n\ndescribe('<DuplicationButton />', () => {\n  let page;\n\n  beforeAll(async () => {\n    // init puppeteer page\n    let browser = await puppeteer.launch();\n    page = await browser.newPage();\n  });\n\n  it('should duplicate content after clicking', async () => {\n    // navigate to fullscreen story\n    await page.goto(\n      '[http://localhost:9009/iframe.html?id=duplicationbutton--good'](http://localhost:9009/iframe.html?id=duplicationbutton--good'),\n    );\n\n    // click on the button\n    await page.click('button');\n\n    // take screenshot and compare\n    const screenshot = await page.screenshot();\n    expect(screenshot).toMatchImageSnapshot();\n  });\n});\n`}</code></pre>\n    <p>{`In order to run this test, we need to start Storybook or you can directly use yarn test:ci which will do it for you! This is how the screenshot looks like:`}</p>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"800px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"75%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAPABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAEF/8QAFAEBAAAAAAAAAAAAAAAAAAAAAP/aAAwDAQACEAMQAAAB36AH/8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQABBQJf/8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAwEBPwE//8QAFBEBAAAAAAAAAAAAAAAAAAAAEP/aAAgBAgEBPwE//8QAFBABAAAAAAAAAAAAAAAAAAAAIP/aAAgBAQAGPwJf/8QAFRABAQAAAAAAAAAAAAAAAAAAIDH/2gAIAQEAAT8hi//aAAwDAQACAAMAAAAQgA//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAEDAQE/ED//xAAUEQEAAAAAAAAAAAAAAAAAAAAQ/9oACAECAQE/ED//xAAWEAEBAQAAAAAAAAAAAAAAAAABESD/2gAIAQEAAT8QAECGv//Z')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/b0c9893d84a8ac70842fbabe0a35eff7/8d2ea/interactive-testing.webp 800w\"],\n            \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/b0c9893d84a8ac70842fbabe0a35eff7/c60e9/interactive-testing.jpg 800w\"],\n            \"sizes\": \"(max-width: 800px) 100vw, 800px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/b0c9893d84a8ac70842fbabe0a35eff7/c60e9/interactive-testing.jpg\",\n            \"alt\": \"Interactive visual testing\",\n            \"title\": \"Interactive visual testing\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Interactive visual testing`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"my-experience-working-with-visual-testing-‚ôÇÔ∏è\"\n    }}>{`My Experience working with Visual Testing üôã‚Äç‚ôÇÔ∏è`}</h2>\n    <p>{`As with all the new technologies/frameworks, I tried Visual testing first with a side project in which I saw a possible improvement. The project itself was a collection of weather icons made with React and `}<a parentName=\"p\" {...{\n        \"href\": \"https://www.styled-components.com/\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`styled-components`}</a>{`, called `}<a parentName=\"p\" {...{\n        \"href\": \"https://github.com/EmaSuriano/weather-styled-icon\",\n        \"target\": \"_blank\",\n        \"rel\": \"noreferrer\"\n      }}>{`weather-styled-icon`}</a>{`.`}</p>\n    <div {...{\n      \"className\": \"Image__Small\"\n    }}>{`\n  `}<img parentName=\"div\" {...{\n        \"src\": \"/edea83629587102745ea8e81f071a5fa/weather-styled-icon.gif\",\n        \"alt\": \"weather-styled-icon showcase\"\n      }}></img>{`\n  `}<figcaption parentName=\"div\">{`weather-styled-icon showcase`}</figcaption>\n    </div>\n    <p>{`The first release I made of this library I wrote all the tests with enzyme, following a structural testing strategy. In simple words, I was rendering an icon with mount and then running checking if a node exists, and in order to check how it ‚Äúlooks‚Äù I was running `}<inlineCode parentName=\"p\">{`expect.toMatchSnapshot`}</inlineCode>{` of the resulting styles. As you can imagine, this way of testing is very time consuming, but nevertheless, I was able to finish all of them.`}</p>\n    <p>{`The problem came when I decided to update the version of styled-components from v3 to v4 because I wanted to start using some of the cool new APIs, like ThemeProvider or the styledAPI to style existing styled-component components.`}</p>\n    <p>{`After I made all the changes inside the code, all my tests were broken due to I moved, added and removed components, also I changed the internal implementation of mostly all of them. At this point, I realized I was testing the implementation of my components and not the really the output I was expecting.`}</p>\n    <p>{`So I made the decision to give a try to Visual Testing because it seemed the most suitable testing strategy for my situation, where I want to check exactly how the icons and them variations looked like. I followed the same steps that I already explained above and I ended up having a better suite of tests with way less code. This is the difference of lines of the merged Pull Request!`}</p>\n    <div {...{\n      \"className\": \"Image__Medium\"\n    }}>{`\n  `}<span parentName=\"div\" {...{\n        \"className\": \"gatsby-resp-image-wrapper\",\n        \"style\": {\n          \"position\": \"relative\",\n          \"display\": \"block\",\n          \"marginLeft\": \"auto\",\n          \"marginRight\": \"auto\",\n          \"maxWidth\": \"1984px\"\n        }\n      }}>{`\n      `}<span parentName=\"span\" {...{\n          \"className\": \"gatsby-resp-image-background-image\",\n          \"style\": {\n            \"paddingBottom\": \"26.108870967741936%\",\n            \"position\": \"relative\",\n            \"bottom\": \"0\",\n            \"left\": \"0\",\n            \"backgroundImage\": \"url('data:image/jpeg;base64,/9j/2wBDABALDA4MChAODQ4SERATGCgaGBYWGDEjJR0oOjM9PDkzODdASFxOQERXRTc4UG1RV19iZ2hnPk1xeXBkeFxlZ2P/2wBDARESEhgVGC8aGi9jQjhCY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2NjY2P/wgARCAAFABQDASIAAhEBAxEB/8QAFgABAQEAAAAAAAAAAAAAAAAAAAIF/8QAFQEBAQAAAAAAAAAAAAAAAAAAAAH/2gAMAwEAAhADEAAAAdygkS//xAAWEAADAAAAAAAAAAAAAAAAAAAAEBH/2gAIAQEAAQUCVP/EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQMBAT8BP//EABQRAQAAAAAAAAAAAAAAAAAAABD/2gAIAQIBAT8BP//EABQQAQAAAAAAAAAAAAAAAAAAABD/2gAIAQEABj8Cf//EABoQAQABBQAAAAAAAAAAAAAAAAEAEBEhMVH/2gAIAQEAAT8hDrejlqf/2gAMAwEAAgADAAAAEPPf/8QAFhEBAQEAAAAAAAAAAAAAAAAAAAER/9oACAEDAQE/EGR//8QAFREBAQAAAAAAAAAAAAAAAAAAABH/2gAIAQIBAT8QV//EABkQAQACAwAAAAAAAAAAAAAAAAEAETFBUf/aAAgBAQABPxBykEcKgDnUAQR//9k=')\",\n            \"backgroundSize\": \"cover\",\n            \"display\": \"block\"\n          }\n        }}></span>{`\n  `}<picture parentName=\"span\">{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/4ac54b8ec14fa1a059df048210fd729d/78dfe/pr-diff.webp 1984w\"],\n            \"sizes\": \"(max-width: 1984px) 100vw, 1984px\",\n            \"type\": \"image/webp\"\n          }}></source>{`\n        `}<source parentName=\"picture\" {...{\n            \"srcSet\": [\"/static/4ac54b8ec14fa1a059df048210fd729d/0ae08/pr-diff.jpg 1984w\"],\n            \"sizes\": \"(max-width: 1984px) 100vw, 1984px\",\n            \"type\": \"image/jpeg\"\n          }}></source>{`\n        `}<img parentName=\"picture\" {...{\n            \"className\": \"gatsby-resp-image-image\",\n            \"src\": \"/static/4ac54b8ec14fa1a059df048210fd729d/0ae08/pr-diff.jpg\",\n            \"alt\": \"Visual testing lines diff weather-styled-icon\",\n            \"title\": \"Visual testing lines diff weather-styled-icon\",\n            \"loading\": \"lazy\",\n            \"style\": {\n              \"width\": \"100%\",\n              \"height\": \"100%\",\n              \"margin\": \"0\",\n              \"verticalAlign\": \"middle\",\n              \"position\": \"absolute\",\n              \"top\": \"0\",\n              \"left\": \"0\"\n            }\n          }}></img>{`\n      `}</picture>{`\n    `}</span>{`\n  `}<figcaption parentName=\"div\">{`Visual testing lines diff weather-styled-icon`}</figcaption>\n    </div>\n    <h2 {...{\n      \"id\": \"dos-and-donts-Ô∏è\"\n    }}>{`Do‚Äôs and Dont‚Äôs ‚úçÔ∏è`}</h2>\n    <p>{`I think Visual Testing is an excellent way of testing and I highly encourage you to at least try it in a side project where you can play with it and see if you like it or not. However, I would like to highlight a few important things to do and NOT to do regarding this topic:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`‚ùå Don‚Äôt check the styles of your components with code, instead, take a real image of the component.`}</li>\n      <li parentName=\"ul\">{`‚úÖ In case you are using Storybook in your development workflow, you can have one visual test for all the stories without any real effort.`}</li>\n      <li parentName=\"ul\">{`‚ùå Visual testing does NOT replace other strategies of testing, it just adds another testing layer to your application.`}</li>\n      <li parentName=\"ul\">{`‚úÖ You can easily integrate it with your current end-to-end tests.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"helpful-resources-\"\n    }}>{`Helpful Resources üìì`}</h2>\n    <ul>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://github.com/EmaSuriano/visual-testing-storybook\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`Link to the sample project`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://github.com/EmaSuriano/weather-styled-icon\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`weather-styled-icon`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://storybook.js.org/docs/testing/automated-visual-testing/\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`Automated Visual Testing ‚Äî Storybook Documentation`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://jestjs.io/docs/en/puppeteer\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`Puppeteer with Jest`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://storybook.js.org/docs/testing/structural-testing/\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`Structural Testing ‚Äî Storybook Documentation`}</a></li>\n      <li parentName=\"ul\"><a parentName=\"li\" {...{\n          \"href\": \"https://facebook.github.io/create-react-app/docs/running-tests#src-setuptestsjs\",\n          \"target\": \"_blank\",\n          \"rel\": \"noreferrer\"\n        }}>{`Extending Jest config in create-react-app`}</a></li>\n    </ul>\n\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"}}